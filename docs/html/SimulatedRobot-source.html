<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OpenSim: robot/sim/SimulatedRobot Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>robot/sim/SimulatedRobot</h1><a href="SimulatedRobot.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* **-*-c++-*-**************************************************************</span>
00002 <span class="comment">  Copyright (C)2002 David Jung &lt;opensim@pobox.com&gt;</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This program/file is free software; you can redistribute it and/or modify</span>
00005 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment">  (at your option) any later version.</span>
00008 <span class="comment">  </span>
00009 <span class="comment">  This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment">  GNU General Public License for more details. (http://www.gnu.org)</span>
00013 <span class="comment">  </span>
00014 <span class="comment">  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment">  along with this program; if not, write to the Free Software</span>
00016 <span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00017 <span class="comment">  </span>
00018 <span class="comment">  $Id: SimulatedRobot 1033 2004-02-11 20:47:52Z jungd $</span>
00019 <span class="comment">  $Revision: 1.22 $</span>
00020 <span class="comment">  $Date: 2004-02-11 15:47:52 -0500 (Wed, 11 Feb 2004) $</span>
00021 <span class="comment">  $Author: jungd $</span>
00022 <span class="comment"> </span>
00023 <span class="comment">****************************************************************************/</span>
00024 
00025 <span class="preprocessor">#ifndef _ROBOT_SIM_SIMULATEDROBOT_</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define _ROBOT_SIM_SIMULATEDROBOT_</span>
00027 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include &lt;<a class="code" href="sim.html">robot/sim/sim</a>&gt;</span>
00029 
00030 <span class="preprocessor">#include &lt;<a class="code" href="Robot.html">robot/Robot</a>&gt;</span>
00031 
00032 <span class="preprocessor">#include &lt;<a class="code" href="VFile.html">base/VFile</a>&gt;</span>
00033 <span class="preprocessor">#include &lt;<a class="code" href="Externalizable.html">base/Externalizable</a>&gt;</span>
00034 <span class="preprocessor">#include &lt;<a class="code" href="Point3.html">base/Point3</a>&gt;</span>
00035 <span class="preprocessor">#include &lt;<a class="code" href="Orient.html">base/Orient</a>&gt;</span>
00036 
00037 <span class="preprocessor">#include &lt;<a class="code" href="SolidSystem.html">physics/SolidSystem</a>&gt;</span>
00038 <span class="preprocessor">#include &lt;<a class="code" href="Spatial.html">physics/Spatial</a>&gt;</span>
00039 <span class="preprocessor">#include &lt;<a class="code" href="SpatialGroup.html">physics/SpatialGroup</a>&gt;</span>
00040 <span class="preprocessor">#include &lt;<a class="code" href="CollidableProvider.html">physics/CollidableProvider</a>&gt;</span>
00041 
00042 <span class="preprocessor">#include &lt;<a class="code" href="BasicControlInterface.html">robot/BasicControlInterface</a>&gt;</span>
00043 <span class="preprocessor">#include &lt;<a class="code" href="ToolDescription.html">robot/ToolDescription</a>&gt;</span>
00044 <span class="preprocessor">#include &lt;<a class="code" href="SimulatedPlatform.html">robot/sim/SimulatedPlatform</a>&gt;</span>
00045 <span class="preprocessor">#include &lt;<a class="code" href="SimulatedSerialManipulator.html">robot/sim/SimulatedSerialManipulator</a>&gt;</span>
00046 <span class="preprocessor">#include &lt;<a class="code" href="SimulatedTool.html">robot/sim/SimulatedTool</a>&gt;</span>
00047 
00048 
00049 <span class="keyword">namespace </span><a class="code" href="robot_2Jamfile_8ft.html#a0">robot</a> {
00050 <span class="keyword">namespace </span><a class="code" href="robot_2Jamfile_8ft.html#a3">sim</a> {
00051 
00052 <span class="comment"></span>
00053 <span class="comment">/**</span>
00054 <span class="comment"> * A concrete Robot class that instantiates a simulated robot</span>
00055 <span class="comment"> *  according to a supplied specification.  Simulated by adding</span>
00056 <span class="comment"> *  bodies, joints and motors to solidSystem.</span>
00057 <span class="comment"> */</span>
<a name="l00058"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html">00058</a> <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html">SimulatedRobot</a> : <span class="keyword">public</span> <a class="code" href="classrobot_1_1Robot.html">Robot</a>, <span class="keyword">public</span> <a class="code" href="physics_2Jamfile_8ft.html#a0">physics</a>::Spatial, <span class="keyword">public</span> <a class="code" href="physics_2Jamfile_8ft.html#a0">physics</a>::CollidableProvider, <span class="keyword">public</span> <a class="code" href="base_2Jamfile_8ft.html#a0">base</a>::Externalizable
00059 {
00060 <span class="keyword">public</span>:
00061   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota0">SimulatedRobot</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;base::VFile&gt;</a> robotSpecification,
00062                  <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; initialPosition, <span class="keyword">const</span> <a class="code" href="classbase_1_1Orient.html">base::Orient</a>&amp; initialOrientation,
00063                  <a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem, <span class="keywordtype">bool</span> dynamic=<span class="keyword">true</span>);
00064 
00065   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota0">SimulatedRobot</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;const robot::RobotDescription&gt;</a> robotDescription,
00066                  <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; initialPosition, <span class="keyword">const</span> <a class="code" href="classbase_1_1Orient.html">base::Orient</a>&amp; initialOrientation,
00067                  <a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem, <span class="keywordtype">bool</span> dynamic=<span class="keyword">true</span>);
00068                  
00069 
<a name="l00070"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota2">00070</a>   <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota2">className</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"SimulatedRobot"</span>); }
00071   
00072   <span class="comment">// factory</span>
<a name="l00073"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota3">00073</a>   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1ref.html">ref&lt;PlatformDescription&gt;</a>    <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota3">newPlatformDescription</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbase_1_1ref.html">ref&lt;PlatformDescription&gt;</a>(<a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="classrobot_1_1PlatformDescription.html">PlatformDescription</a>()); }
<a name="l00074"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota4">00074</a>   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1ref.html">ref&lt;ManipulatorDescription&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota4">newManipulatorDescription</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbase_1_1ref.html">ref&lt;ManipulatorDescription&gt;</a>(<a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="classrobot_1_1ManipulatorDescription.html">ManipulatorDescription</a>()); }
00075 
00076 
00077   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota5">setDynamic</a>(<span class="keywordtype">bool</span> enabled);
00078   
<a name="l00079"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota6">00079</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota6">setSolidSystem</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem)
00080     { this-&gt;solidSystem = solidSystem; }
00081     
00082     
00083   <span class="keyword">virtual</span> array&lt;std::pair&lt;String,String&gt; &gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota7">controlInterfaces</a>() <span class="keyword">const</span>; 
00084 <span class="comment"></span>
00085 <span class="comment">  /**</span>
00086 <span class="comment">   * SimulatedRobot provides the following ControlInterfaces (name:type):</span>
00087 <span class="comment">   *</span>
00088 <span class="comment">   *  platform:PlatformControl                        (only available when dynamic==true)</span>
00089 <span class="comment">   *    - outputs control drive and stearing motors, depending on the specific platform</span>
00090 <span class="comment">   *      (possibly none e.g. for a fixed platform)</span>
00091 <span class="comment">   *      For the basic non-holonomic mobile platform, the first two inputs control</span>
00092 <span class="comment">   *       the left &amp; right drive motor torques and the third control the steering motor</span>
00093 <span class="comment">   *       torque.  The inputs provide the angular velocity of the drive wheels and the</span>
00094 <span class="comment">   *       steering angle.</span>
00095 <span class="comment">   *</span>
00096 <span class="comment">   *  platformVelocity:PlatformVelocityControl        (only available when dynamic==true)</span>
00097 <span class="comment">   *    - As for PlatformControl, but the outputs control target velocity instead of</span>
00098 <span class="comment">   *       torque.</span>
00099 <span class="comment">   *</span>
00100 <span class="comment">   *  platformPosition:PlatformPositionControl        (only available when dynamic==false)</span>
00101 <span class="comment">   *    - outputs control the x,y and angle of the platform w.r.t to the world coordinate frame.</span>
00102 <span class="comment">   *       The angle is clockwise relative to the x-axis (about z).</span>
00103 <span class="comment">   *</span>
00104 <span class="comment">   *  manipulatorN:JointForceControl                  (only available when dynamic==true)</span>
00105 <span class="comment">   *     - where N is the manipulator number (from 1). </span>
00106 <span class="comment">   *       Outputs control joint force/torque and corresponding inputs give joint position.</span>
00107 <span class="comment">   *</span>
00108 <span class="comment">   *  manipulatorVelocityN:JointVelocityControl       (only available when dynamic==true)</span>
00109 <span class="comment">   *     - where N is the manipulator number (from 1).  Outputs control joint velocity</span>
00110 <span class="comment">   *       and corresponding inputs give joint position.</span>
00111 <span class="comment">   *</span>
00112 <span class="comment">   *  manipulatorPositionN:JointPositionControl       </span>
00113 <span class="comment">   *    - outputs control the position of a manipulators joints (angle for revolute joints,</span>
00114 <span class="comment">   *      extension for prismatic joints etc.)</span>
00115 <span class="comment">   *</span>
00116 <span class="comment">   *  manipulatorProximityN:LinkProximitySensors</span>
00117 <span class="comment">   *     - where N is the manipulator number (from 1).</span>
00118 <span class="comment">   *     - Inputs provide proximity sensor information for each link.  Each sequence of 5</span>
00119 <span class="comment">   *        inputs provides the following information on the sensors of a single link:</span>
00120 <span class="comment">   *        0: distance to closest object detected by proximity sensors on the link (or 0 if none detected)</span>
00121 <span class="comment">   *        1-3: (x,y,z) direction vector to the closest object detected by proximity sensors on the link</span>
00122 <span class="comment">   *        4: the distance along the link x-axis of the proximity sensor that detected the closest object to the link</span>
00123 <span class="comment">   *       e.g. l*5 + 0  is the distance to the closest object detected by link l=[0..LastLink] </span>
00124 <span class="comment">   *     - There are no outputs</span>
00125 <span class="comment">   *</span>
00126 <span class="comment">   *  manipulatorToolGripN:ToolGripControl</span>
00127 <span class="comment">   *     - single scalar input represents tool proximity to tool grip mechanism.</span>
00128 <span class="comment">   *       0 =&gt; not in range to be grasped, 1 =&gt; in range to be grasped (or currently grasped)</span>
00129 <span class="comment">   *       single scalar output controls tool gripper latch</span>
00130 <span class="comment">   *       1 =&gt; grasp/latch tool, 0 =&gt; ungrasp/unlatch tool</span>
00131 <span class="comment">   *</span>
00132 <span class="comment">   *  toolN:JointForceControl                         (only available when dynamic==true)</span>
00133 <span class="comment">   *     - joint force/torque output for tool joints (if any); and joint position inputs.</span>
00134 <span class="comment">   *       Note that the inputSize() and outputSize()</span>
00135 <span class="comment">   *       change dynamically depending on which tool is grasped (0 when no tool is grasped)</span>
00136 <span class="comment">   *</span>
00137 <span class="comment">   *  toolVelocityN:JointVelocityControl              (only available when dynamic==true)</span>
00138 <span class="comment">   *     - joint velocity output for tool joints (if any); and joint position inputs.</span>
00139 <span class="comment">   *       Note that the inputSize() and outputSize()</span>
00140 <span class="comment">   *       change dynamically depending on which tool is grasped (0 when no tool is grasped)</span>
00141 <span class="comment">   *</span>
00142 <span class="comment">   *  toolPositionN:JointPositionControl              (only available when dynamic==false)</span>
00143 <span class="comment">   *     - joint position for tool joints (if any).  Note that the inputSize() and outputSize()</span>
00144 <span class="comment">   *       change dynamically depending on which tool is grasped (0 when no tool is grasped)</span>
00145 <span class="comment">   *</span>
00146 <span class="comment">   */</span>
00147   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1ref.html">ref&lt;ControlInterface&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota8">getControlInterface</a>(String interfaceName=<span class="stringliteral">""</span>) <span class="keywordflow">throw</span>(std::invalid_argument);
00148 
<a name="l00149"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota9">00149</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota9">isDescriptionProvided</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }
00150 
<a name="l00151"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota10">00151</a>   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1ref.html">ref&lt;physics::Solid&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota10">getPlatformSolid</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp0">platform</a>-&gt;getPlatformSolid(); }
00152 
00153   
00154   <span class="comment">// Spatial</span>
00155   <span class="comment">// NB: these are intended for static simulations.  Setting the configuration in a dynamic simulation</span>
00156   <span class="comment">//      will result in unrealistic motions - and possibly large forces/instability of system</span>
00157   <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota11">setPosition</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">Point3</a>&amp; pos);
00158   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Vector3.html">Point3</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota12">getPosition</a>() <span class="keyword">const</span>;
00159   <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota13">setOrientation</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Orient.html">Orient</a>&amp; orient);
00160   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Orient.html">Orient</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota14">getOrientation</a>() <span class="keyword">const</span>;
00161   <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota15">setConfiguration</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Transform.html">base::Transform</a>&amp; configuration);
00162   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Transform.html">base::Transform</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota16">getConfiguration</a>() <span class="keyword">const</span>;
00163 
00164   <span class="comment"></span>
00165 <span class="comment">  /// test if tool is in position to be grasped by any end-effectors.</span>
00166 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota17">checkProximity</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedTool&gt;</a> tool);
00167 <span class="comment"></span>
00168 <span class="comment">  /// 'magically' transport a tool to within grasping range of the end-effector</span>
00169 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota18">placeToolInProximity</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedTool&gt;</a> tool, Int manipIndex=0);
00170 <span class="comment"></span>
00171 <span class="comment">  /// gasp tool (if a suitable one is within grasping proximity of the end-effector)</span>
00172 <span class="comment">  ///  returns true if a tool was grasped</span>
00173 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota19">graspTool</a>(Int manipIndex=0);
00174 <span class="comment"></span>
00175 <span class="comment">  /// release grasp</span>
00176 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota20">releaseGrasp</a>(Int manipIndex=0); 
00177 
00178   
00179   <span class="comment">// CollidableProvider</span>
00180   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1ref.html">ref&lt;physics::Collidable&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota21">createCollidable</a>(CollidableFlags flags = 0);
00181   
00182   <span class="comment">// Externalizable</span>
00183   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota22">formatSupported</a>(String format, Real version = 1.0, ExternalizationType type = IO) <span class="keyword">const</span>; <span class="comment">///&lt; query if specific format is supported (for input, output or both)</span>
00184 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobota23">externalize</a>(<a class="code" href="classbase_1_1Externalizer.html">base::Externalizer</a>&amp; e, String format = <span class="stringliteral">""</span>, Real version = 1.0); <span class="comment">///&lt; read or write object state to Externalizer</span>
00185 <span class="comment"></span>
00186 <span class="keyword">protected</span>:<span class="comment"></span>
00187 <span class="comment">  /// construct the physical robot from loaded spec by adding bodies, joints and motors into solidSystem</span>
00188 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotb0">construct</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; initialPosition, <span class="keyword">const</span> <a class="code" href="classbase_1_1Orient.html">base::Orient</a>&amp; initialOrientation);
00189 
<a name="l00190"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp0">00190</a>   <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedPlatform&gt;</a>              <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp0">platform</a>;     <span class="comment">///&lt; simulated robot platform</span>
<a name="l00191"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp1">00191</a> <span class="comment"></span>  <a class="code" href="classbase_1_1reflist.html">reflist&lt;SimulatedSerialManipulator&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp1">manipulators</a>; <span class="comment">///&lt; simulated manipulators</span>
00192 <span class="comment"></span>
<a name="l00193"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp2">00193</a>   <a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem;  <span class="comment">///&lt; SolidSystem into which the robot's physical parts will be added</span>
00194 <span class="comment"></span>
<a name="l00195"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp3">00195</a>   <a class="code" href="classbase_1_1ref.html">ref&lt;physics::SpatialGroup&gt;</a> spatialGroup;   <span class="comment">///&lt; a group containing the platform and manipulators</span>
00196 <span class="comment"></span><span class="comment"></span>
00197 <span class="comment">  /// if true, full physics is simulated; if false, the Solids that comprise the Robot only have a position/orientation - no velocity/acceleration</span>
00198 <span class="comment">  ///  (and the position based ControlInterfaces can be used instead of the velocity &amp; force/torque interfaces)</span>
<a name="l00199"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotp4">00199</a> <span class="comment"></span>  <span class="keywordtype">bool</span> dynamic; 
00200   
00201 <span class="comment"></span>
00202 <span class="comment">  /// ForceControl &amp; VelControl require a dynamic simulation; PosControl will also function for</span>
00203 <span class="comment">  ///  simple non-dynamic simulations</span>
<a name="l00204"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotx3">00204</a> <span class="comment"></span>  <span class="keyword">enum</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotx3">ControlType</a> { <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotx3robot_1_1sim_1_1SimulatedRobotx0">ForceControl</a>, <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotx3robot_1_1sim_1_1SimulatedRobotx1">VelControl</a>, <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html#robot_1_1sim_1_1SimulatedRobotx3robot_1_1sim_1_1SimulatedRobotx2">PosControl</a> };
00205   
00206 
<a name="l00207"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html">00207</a>   <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html">ManipulatorControlInterface</a> : <span class="keyword">public</span> <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>
00208   {
00209   <span class="keyword">public</span>:
<a name="l00210"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea0">00210</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea0">ManipulatorControlInterface</a>(<span class="keyword">const</span> String&amp; name, <span class="keyword">const</span> String&amp; type, 
00211                                 <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedSerialManipulator&gt;</a> sm, ControlType controlType = ForceControl)
00212       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(name, type,
00213                               sm-&gt;getManipulatorDescription()-&gt;getKinematicChain().dof(),
00214                               sm-&gt;getManipulatorDescription()-&gt;getKinematicChain().dof() ),
00215         sm(sm), <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a>(<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a>) {}
00216 
<a name="l00217"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea1">00217</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea0">ManipulatorControlInterface</a>(<span class="keyword">const</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html">ManipulatorControlInterface</a>&amp; mci)
00218       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(mci), <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>(mci.<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>), <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a>(mci.<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a>) {}
00219 
<a name="l00220"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea2">00220</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea2">className</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"ManipulatorControlInterface"</span>); }
<a name="l00221"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea3">00221</a>     <span class="keyword">virtual</span> Object&amp; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea3">clone</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea0">ManipulatorControlInterface</a>(*<span class="keyword">this</span>); } 
00222 
<a name="l00223"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea4">00223</a>     <span class="keyword">virtual</span> String        <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea4">inputName</a>(Int i)<span class="keyword"> const</span>
00224 <span class="keyword">      </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"jointPosition"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i); }
00225 
<a name="l00226"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea5">00226</a>     <span class="keyword">virtual</span> Real          <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea5">getInput</a>(Int i)<span class="keyword"> const</span>
00227 <span class="keyword">      </span>{ 
00228         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1BasicControlInterface.html#robot_1_1TestRobot_1_1ProximitySensorInterfacea8">inputSize</a>());
00229         <span class="keywordflow">return</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>-&gt;getJointPos(i+1);
00230       }
00231 
<a name="l00232"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea6">00232</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea6">outputName</a>(Int i)<span class="keyword"> const</span>
00233 <span class="keyword">      </span>{ 
00234         <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a> == ForceControl)
00235           <span class="keywordflow">return</span> String(<span class="stringliteral">"jointForce"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i); 
00236         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a> == VelControl)
00237           <span class="keywordflow">return</span> String(<span class="stringliteral">"jointVelocity"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i); 
00238         <span class="keywordflow">else</span>
00239           <span class="keywordflow">return</span> String(<span class="stringliteral">"jointPosition"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i); 
00240       }
00241 
<a name="l00242"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea7">00242</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacea7">setOutput</a>(Int i, Real value)
00243       {
00244         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1BasicControlInterface.html#robot_1_1TestRobot_1_1ProximitySensorInterfacea10">outputSize</a>());
00245         <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a> == ForceControl)
00246           <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>-&gt;setJointForce(i+1, value);
00247         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a> == VelControl)
00248           <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>-&gt;setJointVel(i+1, value);
00249         <span class="keywordflow">else</span>
00250           <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>-&gt;setJointPos(i+1, value);
00251       }
00252 
00253   <span class="keyword">protected</span>:
<a name="l00254"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">00254</a>     <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedSerialManipulator&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep0">sm</a>;
<a name="l00255"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">00255</a>     ControlType <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ManipulatorControlInterfacep1">controlType</a>;
00256   };
00257 
00258 
00259 
00260 
<a name="l00261"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html">00261</a>   <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html">ToolControlInterface</a> : <span class="keyword">public</span> <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>
00262   {
00263   <span class="keyword">public</span>:
<a name="l00264"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea0">00264</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea0">ToolControlInterface</a>(<span class="keyword">const</span> String&amp; name, <span class="keyword">const</span> String&amp; type, <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedSerialManipulator&gt;</a> sm, 
00265                          <span class="keywordtype">bool</span> gripControl, ControlType controlType = ForceControl)
00266       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(name, type, gripControl?1:0, gripControl?1:0),
00267         gripControl(gripControl), sm(sm), controlType(controlType) {}
00268     
<a name="l00269"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea1">00269</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea0">ToolControlInterface</a>(<span class="keyword">const</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html">ToolControlInterface</a>&amp; tci)
00270       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(tci), <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>(tci.<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>), 
00271         sm(tci.sm), controlType(tci.controlType) {}
00272 
<a name="l00273"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea2">00273</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea2">className</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"ToolControlInterface"</span>); }
<a name="l00274"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea3">00274</a>     <span class="keyword">virtual</span> Object&amp; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea3">clone</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea0">ToolControlInterface</a>(*<span class="keyword">this</span>); }
00275 
<a name="l00276"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea4">00276</a>     <span class="keyword">virtual</span> Int           <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea4">inputSize</a>()<span class="keyword"> const </span>
00277 <span class="keyword">    </span>{
00278       <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>) <span class="keywordflow">return</span> 1;
00279       <span class="keywordflow">if</span> (sm-&gt;isToolGrasped()) <span class="keywordflow">return</span> sm-&gt;getToolInProximity()-&gt;getToolDescription()-&gt;getKinematicChain().dof();
00280       <span class="keywordflow">return</span> 0;
00281     }
00282 
<a name="l00283"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea5">00283</a>     <span class="keyword">virtual</span> String        <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea5">inputName</a>(Int i)<span class="keyword"> const</span>
00284 <span class="keyword">      </span>{ <span class="keywordflow">return</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>?String(<span class="stringliteral">"toolProximity"</span>):String(<span class="stringliteral">"jointPosition"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i); }
00285 
<a name="l00286"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea6">00286</a>     <span class="keyword">virtual</span> Real          <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea6">getInput</a>(Int i)<span class="keyword"> const</span>
00287 <span class="keyword">      </span>{ 
00288         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea4">inputSize</a>());
00289         <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>) {
00290           <span class="keywordflow">if</span> (sm-&gt;isToolGrasped()) <span class="keywordflow">return</span> 1;
00291           <span class="keywordflow">if</span> (sm-&gt;getToolInProximity())
00292             <span class="keywordflow">return</span> sm-&gt;checkProximity(sm-&gt;getToolInProximity())?1.0:0.0;
00293         }
00294         <span class="keywordflow">if</span> (sm-&gt;isToolGrasped()) 
00295           <span class="keywordflow">return</span> sm-&gt;getToolInProximity()-&gt;getJointPos(i+1);
00296         <span class="keywordflow">return</span> 0;
00297       }
00298 
<a name="l00299"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea7">00299</a>     <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classbase_1_1vector.html">Vector</a>&amp; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea7">getInputs</a>()<span class="keyword"> const </span>
00300 <span class="keyword">      </span>{
00301         Int s = <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea4">inputSize</a>();
00302         lastInputs.<a class="code" href="classbase_1_1vector.html#base_1_1vectora14">resize</a>(s);
00303         <span class="keywordflow">for</span>(Int i=0; i&lt;s; i++)
00304           lastInputs[i] = <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea6">getInput</a>(i);
00305         <span class="keywordflow">return</span> lastInputs;
00306       }
00307 
<a name="l00308"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea8">00308</a>     <span class="keyword">virtual</span> Int    <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea8">outputSize</a>()<span class="keyword"> const </span>
00309 <span class="keyword">      </span>{
00310         <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>) <span class="keywordflow">return</span> 1;
00311         <span class="keywordflow">if</span> (sm-&gt;isToolGrasped()) <span class="keywordflow">return</span> sm-&gt;getToolInProximity()-&gt;getToolDescription()-&gt;getKinematicChain().dof();
00312         <span class="keywordflow">return</span> 0;
00313       }
00314 
<a name="l00315"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea9">00315</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea9">outputName</a>(Int i)<span class="keyword"> const</span>
00316 <span class="keyword">      </span>{ 
00317         <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>) <span class="keywordflow">return</span> String(<span class="stringliteral">"toolGrasp"</span>);
00318         <span class="keywordflow">if</span> (controlType==ForceControl) <span class="keywordflow">return</span> String(<span class="stringliteral">"jointForce"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i);
00319         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (controlType==VelControl) <span class="keywordflow">return</span> String(<span class="stringliteral">"jointVelocity"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i);
00320         <span class="keywordflow">else</span> <span class="keywordflow">return</span> String(<span class="stringliteral">"jointPosition"</span>)+<a class="code" href="namespacebase.html#a50">base::intToString</a>(i);
00321       }
00322 
<a name="l00323"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea10">00323</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea10">setOutput</a>(Int i, Real value)
00324       {
00325         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea8">outputSize</a>());
00326         <span class="keywordflow">if</span> (<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>) {
00327           <span class="keywordflow">if</span> (Math::equals(value,0)) 
00328             sm-&gt;releaseGrasp();
00329           <span class="keywordflow">else</span>
00330             sm-&gt;graspTool();
00331           <span class="keywordflow">return</span>;
00332         }
00333         <span class="keywordflow">if</span> (sm-&gt;isToolGrasped()) {
00334           <span class="keywordflow">if</span> (controlType==ForceControl)
00335             sm-&gt;getToolInProximity()-&gt;setJointForce(i+1, value);
00336           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (controlType==VelControl)
00337             sm-&gt;getToolInProximity()-&gt;setJointVel(i+1, value);
00338           <span class="keywordflow">else</span> 
00339             sm-&gt;getToolInProximity()-&gt;setJointPos(i+1, value);
00340         }
00341       }
00342 
<a name="l00343"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea11">00343</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea11">setOutputs</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1vector.html">Vector</a>&amp; values) 
00344       {
00345         numOutputs = <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacea8">outputSize</a>();
00346         BasicControlInterface::setOutputs(values);
00347       }
00348 
00349   <span class="keyword">protected</span>:
<a name="l00350"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">00350</a>     <span class="keywordtype">bool</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep0">gripControl</a>; <span class="comment">///&lt; is this a ToolGripControl? (or a JointPositionControl)</span>
<a name="l00351"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep1">00351</a> <span class="comment"></span>    <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedSerialManipulator&gt;</a> sm;
<a name="l00352"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ToolControlInterfacep2">00352</a>     ControlType controlType;
00353    };
00354 
00355 
00356 
00357 
<a name="l00358"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html">00358</a>   <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html">PlatformControlInterface</a> : <span class="keyword">public</span> <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>
00359   {
00360   <span class="keyword">public</span>:
<a name="l00361"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea0">00361</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea0">PlatformControlInterface</a>(<span class="keyword">const</span> String&amp; name, <span class="keyword">const</span> String&amp; type, 
00362                              <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedRobot&gt;</a> sr, <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedPlatform&gt;</a> sp, 
00363                              ControlType controlType=ForceControl)
00364       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(name, type,
00365                               sp-&gt;getPlatformDescription()-&gt;isMobile()?3:0,
00366                               sp-&gt;getPlatformDescription()-&gt;isMobile()?3:0),
00367         sr(sr), sp(sp), controlType(controlType) {}
00368 
<a name="l00369"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea1">00369</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea0">PlatformControlInterface</a>(<span class="keyword">const</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html">PlatformControlInterface</a>&amp; pci)
00370       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(pci), <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>(pci.<a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>), sp(pci.sp), controlType(pci.controlType) {}
00371 
<a name="l00372"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea2">00372</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea2">className</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"PlatformControlInterface"</span>); }
<a name="l00373"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea3">00373</a>     <span class="keyword">virtual</span> Object&amp; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea3">clone</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea0">PlatformControlInterface</a>(*<span class="keyword">this</span>); } 
00374 
<a name="l00375"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea4">00375</a>     <span class="keyword">virtual</span> String        <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea4">inputName</a>(Int i)<span class="keyword"> const</span>
00376 <span class="keyword">    </span>{
00377       <span class="keywordflow">if</span> (controlType != PosControl)
00378         <span class="keywordflow">return</span> (i==0)?String(<span class="stringliteral">"leftDriveWheelVelocity"</span>):( (i==1)?String(<span class="stringliteral">"rightDriveWheelVelocity"</span>):String(<span class="stringliteral">"steeringAngle"</span>) );
00379       <span class="keywordflow">else</span>
00380         <span class="keywordflow">return</span> (i==0)?String(<span class="stringliteral">"x"</span>):( (i==1)?String(<span class="stringliteral">"y"</span>):String(<span class="stringliteral">"theta"</span>) );
00381     }
00382 
<a name="l00383"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea5">00383</a>     <span class="keyword">virtual</span> Real          <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea5">getInput</a>(Int i)<span class="keyword"> const</span>
00384 <span class="keyword">      </span>{ 
00385         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1BasicControlInterface.html#robot_1_1TestRobot_1_1ProximitySensorInterfacea8">inputSize</a>());
00386         <span class="keywordflow">if</span> (controlType != PosControl) {
00387           <span class="keywordflow">if</span> (i==0) <span class="keywordflow">return</span> sp-&gt;getLeftBackWheelVel();
00388           <span class="keywordflow">if</span> (i==1) <span class="keywordflow">return</span> sp-&gt;getRightBackWheelVel();
00389           <span class="keywordflow">return</span> sp-&gt;getSteeringAngle();
00390         }
00391         <span class="keywordflow">else</span> {
00392           <span class="keywordflow">if</span> (i==0) <span class="keywordflow">return</span> sp-&gt;getPosition2D().x;
00393           <span class="keywordflow">if</span> (i==1) <span class="keywordflow">return</span> sp-&gt;getPosition2D().y;
00394           <span class="keywordflow">return</span> sp-&gt;getOrientation2D();
00395         }
00396       }
00397 
<a name="l00398"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea6">00398</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea6">outputName</a>(Int i)<span class="keyword"> const</span>
00399 <span class="keyword">      </span>{ 
00400         <span class="keywordflow">if</span> (controlType==ForceControl) 
00401           <span class="keywordflow">return</span> (i==0)?String(<span class="stringliteral">"leftDriveWheelTorque"</span>):( (i==1)?String(<span class="stringliteral">"rightDriveWheelTorque"</span>):String(<span class="stringliteral">"steeringTorque"</span>) ); 
00402         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (controlType==VelControl)
00403           <span class="keywordflow">return</span> (i==0)?String(<span class="stringliteral">"leftDriveWheelVelocity"</span>):( (i==1)?String(<span class="stringliteral">"rightDriveWheelVelocity"</span>):String(<span class="stringliteral">"steeringVelocity"</span>) );
00404         <span class="keywordflow">else</span>
00405           <span class="keywordflow">return</span> (i==0)?String(<span class="stringliteral">"x"</span>):( (i==1)?String(<span class="stringliteral">"y"</span>):String(<span class="stringliteral">"theta"</span>) );
00406       }
00407 
<a name="l00408"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea7">00408</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacea7">setOutput</a>(Int i, Real value)
00409       {
00410         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1BasicControlInterface.html#robot_1_1TestRobot_1_1ProximitySensorInterfacea10">outputSize</a>());
00411         <span class="keywordflow">if</span> (controlType==ForceControl) {
00412           <span class="keywordflow">if</span> (i==0)
00413             sp-&gt;setLeftBackWheelTorque(value);
00414           <span class="keywordflow">else</span> {
00415             <span class="keywordflow">if</span> (i==1)
00416               sp-&gt;setRightBackWheelTorque(value);
00417             <span class="keywordflow">else</span>
00418               sp-&gt;setSteeringTorque(value);
00419           }
00420         }
00421         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (controlType==VelControl) {
00422           <span class="keywordflow">if</span> (i==0)
00423             sp-&gt;setLeftBackWheelVel(value);
00424           <span class="keywordflow">else</span> {
00425             <span class="keywordflow">if</span> (i==1)
00426               sp-&gt;setRightBackWheelVel(value);
00427             <span class="keywordflow">else</span>
00428               sp-&gt;setSteeringVel(value);
00429           }
00430         }
00431         <span class="keywordflow">else</span> {
00432           <span class="comment">// move the robot</span>
00433           <a class="code" href="classbase_1_1Vector2.html">Point2</a> p( <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>-&gt;getPosition2D() );
00434           Real theta = <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>-&gt;getOrientation2D();
00435           <span class="keywordflow">if</span> (i==0) 
00436             <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>-&gt;setPosition2D( <a class="code" href="classbase_1_1Vector2.html">Point2</a>(value, p.<a class="code" href="classbase_1_1Vector2.html#base_1_1Vector2o1">y</a>), theta );
00437           <span class="keywordflow">else</span> {
00438             <span class="keywordflow">if</span> (i==1) 
00439               <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>-&gt;setPosition2D( <a class="code" href="classbase_1_1Vector2.html">Point2</a>(p.<a class="code" href="classbase_1_1Vector2.html#base_1_1Vector2o0">x</a>, value), theta );
00440             <span class="keywordflow">else</span> 
00441               <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>-&gt;setPosition2D( p, value );
00442           }
00443         }
00444       }
00445 
00446   <span class="keyword">protected</span>:
<a name="l00447"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">00447</a>     <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedRobot&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep0">sr</a>;
<a name="l00448"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep1">00448</a>     <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedPlatform&gt;</a> sp;
<a name="l00449"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1PlatformControlInterfacep2">00449</a>     ControlType controlType;
00450   };
00451 
00452   
00453 
<a name="l00454"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html">00454</a>   <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html">ProximitySensorInterface</a> : <span class="keyword">public</span> <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>
00455   {
00456   <span class="keyword">public</span>:
<a name="l00457"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea0">00457</a>     <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea0">ProximitySensorInterface</a>(<span class="keyword">const</span> String&amp; name, <span class="keyword">const</span> String&amp; type,
00458                              <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedSerialManipulator&gt;</a> sm)
00459       : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(name, type, (sm-&gt;getManipulatorDescription()-&gt;getKinematicChain().size()+1)*5, 0),
00460         sm(sm) {}
00461       
<a name="l00462"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea1">00462</a>    <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea0">ProximitySensorInterface</a>(<span class="keyword">const</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html">ProximitySensorInterface</a>&amp; psi)
00463      : <a class="code" href="classrobot_1_1BasicControlInterface.html">BasicControlInterface</a>(psi), sm(psi.sm) {}
00464   
<a name="l00465"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea2">00465</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea2">className</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"ProximitySensorInterface"</span>); }
<a name="l00466"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea3">00466</a>     <span class="keyword">virtual</span> Object&amp; <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea3">clone</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea0">ProximitySensorInterface</a>(*<span class="keyword">this</span>); }
00467     
<a name="l00468"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea4">00468</a>     <span class="keyword">virtual</span> String        <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea4">inputName</a>(Int i)<span class="keyword"> const</span>
00469 <span class="keyword">      </span>{
00470         <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1BasicControlInterface.html#robot_1_1TestRobot_1_1ProximitySensorInterfacea8">inputSize</a>() );
00471         Int linkNo = (i/5);
00472         Int dataIndex = i%5;
00473         String name(String(<span class="stringliteral">"proximitySensor"</span>)+base::intToString(linkNo));
00474         <span class="keywordflow">switch</span> (dataIndex) {
00475           <span class="keywordflow">case</span> 0: name+=<span class="stringliteral">" distance"</span>; <span class="keywordflow">break</span>;
00476           <span class="keywordflow">case</span> 1: name+=<span class="stringliteral">" normal.x"</span>; <span class="keywordflow">break</span>;
00477           <span class="keywordflow">case</span> 2: name+=<span class="stringliteral">" normal.y"</span>; <span class="keywordflow">break</span>;
00478           <span class="keywordflow">case</span> 3: name+=<span class="stringliteral">" normal.z"</span>; <span class="keywordflow">break</span>;
00479           <span class="keywordflow">case</span> 4: name+=<span class="stringliteral">" sensor position"</span>; <span class="keywordflow">break</span>;
00480           <span class="keywordflow">default</span>:;
00481         }
00482         <span class="keywordflow">return</span> name;
00483       }
00484   
<a name="l00485"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea5">00485</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea5">outputName</a>(Int i)<span class="keyword"> const </span>{ <a class="code" href="base.html#a21">Assertm</a>(<span class="keyword">false</span>,<span class="stringliteral">"interface has outputs"</span>); <span class="keywordflow">return</span> <span class="stringliteral">""</span>; }
00486 
<a name="l00487"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea6">00487</a>     <span class="keyword">virtual</span> Real          <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea6">getInput</a>(Int i)<span class="keyword"> const</span>
00488 <span class="keyword">    </span>{
00489       <a class="code" href="base.html#a19">Assert</a>(i &lt; <a class="code" href="classrobot_1_1BasicControlInterface.html#robot_1_1TestRobot_1_1ProximitySensorInterfacea8">inputSize</a>());
00490       Int linkNo = (i/5);
00491       Int dataIndex = i%5;
00492       <span class="keywordflow">switch</span> (dataIndex) {
00493           <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> sm-&gt;getClosestObjectDistance(linkNo);
00494           <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> sm-&gt;getClosestObjectDirection(linkNo).x;
00495           <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> sm-&gt;getClosestObjectDirection(linkNo).y;
00496           <span class="keywordflow">case</span> 3: <span class="keywordflow">return</span> sm-&gt;getClosestObjectDirection(linkNo).z;
00497           <span class="keywordflow">case</span> 4: <span class="keywordflow">return</span> sm-&gt;getClosestObjectSensorPosition(linkNo);
00498           <span class="keywordflow">default</span>:;
00499       }
00500       <span class="keywordflow">return</span> 0;
00501     }
00502     
00503     
<a name="l00504"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea7">00504</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span>   <a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacea7">setOutput</a>(Int i, Real value) { <a class="code" href="base.html#a21">Assertm</a>(<span class="keyword">false</span>,<span class="stringliteral">"interface has outputs"</span>); }
00505     
00506   <span class="keyword">protected</span>:
<a name="l00507"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterface.html#robot_1_1sim_1_1SimulatedRobot_1_1ProximitySensorInterfacep0">00507</a>     <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedSerialManipulator&gt;</a> sm;
00508   };
00509     
00510 
00511 };
00512 
00513 
00514 
00515 }
00516 } <span class="comment">// robot::sim</span>
00517 
00518 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Jul 29 15:56:41 2004 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
