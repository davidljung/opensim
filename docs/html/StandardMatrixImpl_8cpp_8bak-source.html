<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/home/jungd/unix/dev/OpenSim/opensim/base/StandardMatrixImpl.cpp.bak Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>/home/jungd/unix/dev/OpenSim/opensim/base/StandardMatrixImpl.cpp.bak</h1><a href="StandardMatrixImpl_8cpp_8bak.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/****************************************************************************</font>
00002 <font class="comment">  Copyright (C)1996 David Jung &lt;djung@pobox.com&gt;</font>
00003 <font class="comment"></font>
00004 <font class="comment">  This program/file is free software; you can redistribute it and/or modify</font>
00005 <font class="comment">  it under the terms of the GNU General Public License as published by</font>
00006 <font class="comment">  the Free Software Foundation; either version 2 of the License, or</font>
00007 <font class="comment">  (at your option) any later version.</font>
00008 <font class="comment">  </font>
00009 <font class="comment">  This program is distributed in the hope that it will be useful,</font>
00010 <font class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00011 <font class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font>
00012 <font class="comment">  GNU General Public License for more details. (http://www.gnu.org)</font>
00013 <font class="comment">  </font>
00014 <font class="comment">  You should have received a copy of the GNU General Public License</font>
00015 <font class="comment">  along with this program; if not, write to the Free Software</font>
00016 <font class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</font>
00017 <font class="comment">  </font>
00018 <font class="comment">  $Id: Matrix.cpp,v 1.6 2001/05/22 19:24:19 jungd Exp $</font>
00019 <font class="comment">  $Revision: 1.6 $</font>
00020 <font class="comment">  $Date: 2001/05/22 19:24:19 $</font>
00021 <font class="comment">  $Author: jungd $</font>
00022 <font class="comment"> </font>
00023 <font class="comment">****************************************************************************/</font>
00024 
00025 <font class="preprocessor">#include &lt;base/StandardMatrixImpl&gt;</font>
00026 
00027 <font class="keyword">using</font> <a class="code" href="classbase_1_1MatrixImpl.html">base::MatrixImpl</a>;
00028 <font class="keyword">using</font> <a class="code" href="classbase_1_1StandardMatrixImpl.html">base::StandardMatrixImpl</a>;
00029 <font class="keyword">using</font> <a class="code" href="classbase_1_1Vector.html">base::Vector</a>;
00030 <font class="keyword">using</font> <a class="code" href="classbase_1_1Matrix4.html">base::Matrix4</a>;
00031 <font class="keyword">using</font> <a class="code" href="classbase_1_1Vector4.html">base::Vector4</a>;
00032 <font class="keyword">using</font> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>;
00033 
00034 <font class="keyword">using</font> std::ostream;
00035 
00036 
00037 
00038 <font class="keyword">inline</font> <font class="keyword">static</font> <font class="keywordtype">void</font> exchange(<a class="code" href="namespacebase.html#a5">Real</a>&amp; a, <a class="code" href="namespacebase.html#a5">Real</a>&amp; b)
00039 {
00040   <a class="code" href="namespacebase.html#a5">Real</a> t(a);
00041   a = b;
00042   b = t;
00043 }
00044 
00045 <font class="comment">// row, col element exchange</font>
<a name="l00046"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImplb1">00046</a> <font class="keyword">inline</font> <font class="keywordtype">void</font> StandardMatrixImpl::rcswap(<a class="code" href="namespacebase.html#a2">Int</a> r, <a class="code" href="namespacebase.html#a2">Int</a> c) 
00047 {
00048   <a class="code" href="namespacebase.html#a5">Real</a>* rcp = &amp;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>[<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImplb0">offset</a>(r,c)];
00049   <a class="code" href="namespacebase.html#a5">Real</a>* crp = &amp;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>[<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImplb0">offset</a>(c,r)];
00050   exchange(*rcp, *crp);
00051 }
00052 
00053 
00054 
<a name="l00055"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla0">00055</a> StandardMatrixImpl::StandardMatrixImpl(<a class="code" href="namespacebase.html#a2">Int</a> rows=1, <a class="code" href="namespacebase.html#a2">Int</a> cols=1)
00056   : MatrixImpl(rows,cols)
00057 {
00058   <font class="keywordflow">if</font> ((<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>==0) || (cols==0))
00059     <font class="keywordflow">throw</font> std::invalid_argument(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"Matrix rows and cols must be &gt; 0"</font>));
00060   
00061   <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a> = <a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="namespacebase.html#a5">Real</a>[<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>*<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>];
00062 }
00063 
<a name="l00064"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla1">00064</a> StandardMatrixImpl::StandardMatrixImpl(<font class="keyword">const</font> MatrixImpl&amp; m) 
00065   : MatrixImpl(m)
00066 {
00067   this-&gt;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a> = <a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="namespacebase.html#a5">Real</a>[<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>*<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>];
00068   this-&gt;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla16">operator=</a>(<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>); 
00069 }
00070 
<a name="l00071"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla2">00071</a> StandardMatrixImpl::StandardMatrixImpl(<font class="keyword">const</font> StandardMatrixImpl&amp; m) 
00072   : MatrixImpl(m)
00073 {
00074   this-&gt;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a> = <a class="code" href="MemoryTracer.html#a0">NewObj</a> <a class="code" href="namespacebase.html#a5">Real</a>[<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>*<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>];
00075   this-&gt;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla16">operator=</a>(<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>); 
00076 }
00077 
<a name="l00078"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla3">00078</a> StandardMatrixImpl::~StandardMatrixImpl() 
00079 {
00080   <font class="keyword">delete</font>[] <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>; 
00081 }
00082 
00083 
00084 
<a name="l00085"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla14">00085</a> <a class="code" href="namespacebase.html#a5">Real</a>&amp; StandardMatrixImpl::e(<a class="code" href="namespacebase.html#a2">Int</a> row, <a class="code" href="namespacebase.html#a2">Int</a> col) <font class="keywordflow">throw</font>()
00086 {
00087 <font class="preprocessor">#ifdef DEBUG</font>
00088 <font class="preprocessor"></font>  <font class="keywordflow">try</font> {
00089     <font class="keywordflow">return</font> m[offset(row,col)]; 
00090   } <font class="keywordflow">catch</font> (std::exception&amp; e) {
00091     <a class="code" href="base.html#a3">Logln</a>(<font class="stringliteral">"offset exception"</font>);
00092     <font class="keywordflow">return</font> m[0];
00093   }
00094 <font class="preprocessor">#else</font>
00095 <font class="preprocessor"></font>  <font class="keywordflow">return</font> m[offset(row,col)]; 
00096 <font class="preprocessor">#endif</font>
00097 <font class="preprocessor"></font>}
00098 
<a name="l00099"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla15">00099</a> <font class="keyword">const</font> <a class="code" href="namespacebase.html#a5">Real</a>&amp; StandardMatrixImpl::e(<a class="code" href="namespacebase.html#a2">Int</a> row, <a class="code" href="namespacebase.html#a2">Int</a> col) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00100 {
00101 <font class="preprocessor">#ifdef DEBUG</font>
00102 <font class="preprocessor"></font>  <font class="keywordflow">try</font> {
00103     <font class="keywordflow">return</font> m[offset(row,col)]; 
00104   } <font class="keywordflow">catch</font> (std::exception&amp; e) {
00105     <a class="code" href="base.html#a3">Logln</a>(<font class="stringliteral">"offset exception"</font>);
00106     <font class="keywordflow">return</font> m[0];
00107   }
00108 <font class="preprocessor">#else</font>
00109 <font class="preprocessor"></font>  <font class="keywordflow">return</font> m[offset(row,col)]; 
00110 <font class="preprocessor">#endif</font>
00111 <font class="preprocessor"></font>}
00112 
00113 
<a name="l00114"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla6">00114</a> <font class="keywordtype">void</font> StandardMatrixImpl::setDiagonal(<a class="code" href="namespacebase.html#a5">Real</a> d) <font class="keywordflow">throw</font>()
00115 {
00116   <a class="code" href="namespacebase.html#a67">clearMemory</a>(m, nr*nc); <font class="comment">// zero</font>
00117   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> rc=1; rc&lt;=<a class="code" href="namespacebase.html#a81">minimum</a>(nr,nc); rc++)
00118     m[offset(rc,rc)] = d;
00119 }
00120 
00121 
00122 
00123 
<a name="l00124"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla13">00124</a> <font class="keywordtype">void</font> StandardMatrixImpl::resize(<a class="code" href="namespacebase.html#a2">Int</a> rows, <a class="code" href="namespacebase.html#a2">Int</a> cols, <font class="keyword">const</font> <a class="code" href="namespacebase.html#a5">Real</a>&amp; diagonal)
00125 {
00126   <font class="keywordflow">if</font> ((<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a> == this-&gt;<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>()) &amp;&amp; (cols == <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla32">columns</a>()))
00127     <font class="keywordflow">return</font>;
00128 
00129   <font class="keywordflow">if</font> ((<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>==0) || (cols==0))
00130     <font class="keywordflow">throw</font> std::invalid_argument(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"Matrix rows and cols must be &gt; 0"</font>));
00131 
00132   <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla0">StandardMatrixImpl</a> newm(<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>, cols);
00133   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=1; r&lt;=<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>; r++)
00134     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=1; c&lt;=cols; c++)
00135       <font class="keywordflow">if</font> ((r&lt;=this-&gt;<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>()) &amp;&amp; (c&lt;=<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla32">columns</a>()))
00136   newm.e(r,c) = <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla14">e</a>(r,c);
00137       <font class="keywordflow">else</font>
00138   newm.e(r,c) = (r!=c)?<a class="code" href="namespacebase.html#a5">Real</a>(0):diagonal;
00139 
00140   <a class="code" href="namespacebase.html#a5">Real</a>* tmpm = <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>;
00141   <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a> = newm.m;
00142   newm.m = tmpm;
00143 
00144   <a class="code" href="namespacebase.html#a2">Int</a> tmpnr = <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>;
00145   <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a> = newm.nr;
00146   newm.nr = tmpnr;
00147 
00148   <a class="code" href="namespacebase.html#a2">Int</a> tmpnc = <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>;
00149   <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a> = newm.nc;
00150   newm.nc = tmpnc;
00151 }
00152 
00153 
00154 
<a name="l00155"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla7">00155</a> <a class="code" href="namespacebase.html#a34">Vector</a> StandardMatrixImpl::getRow(<a class="code" href="namespacebase.html#a2">Int</a> row) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00156 {
00157   <a class="code" href="namespacebase.html#a34">Vector</a> rowVector(nc);
00158   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=1; c&lt;=nc; c++)
00159     rowVector[c] = e(row,c);
00160   <font class="keywordflow">return</font> rowVector;
00161 }
00162 
<a name="l00163"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla8">00163</a> <font class="keywordtype">void</font> StandardMatrixImpl::setRow(<a class="code" href="namespacebase.html#a2">Int</a> row, <font class="keyword">const</font> <a class="code" href="namespacebase.html#a34">Vector</a>&amp; rowVector) <font class="keywordflow">throw</font>()
00164 {
00165   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=1; c&lt;=nc; c++)
00166     e(row,c) = rowVector[c];
00167 }
00168 
<a name="l00169"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla9">00169</a> <a class="code" href="namespacebase.html#a34">Vector</a> StandardMatrixImpl::getColumn(<a class="code" href="namespacebase.html#a2">Int</a> col) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00170 {
00171   <a class="code" href="namespacebase.html#a34">Vector</a> colVector(nr);
00172   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=1; r&lt;=nr; r++)
00173     colVector[r] = e(r,col);
00174   <font class="keywordflow">return</font> colVector;
00175 }
00176 
<a name="l00177"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla10">00177</a> <font class="keywordtype">void</font> StandardMatrixImpl::setColumn(<a class="code" href="namespacebase.html#a2">Int</a> col, <font class="keyword">const</font> <a class="code" href="namespacebase.html#a34">Vector</a>&amp; colVector) <font class="keywordflow">throw</font>()
00178 {
00179   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=1; r&lt;=nr; r++)
00180     e(r,col) = colVector[r];
00181 }
00182 
00183 
<a name="l00184"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla16">00184</a> MatrixImpl&amp; StandardMatrixImpl::operator=(<font class="keyword">const</font> MatrixImpl&amp; src) <font class="keywordflow">throw</font>()
00185 {
00186   <font class="keywordflow">if</font> (&amp;src == <font class="keyword">this</font>) <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00187 
00188   <font class="keywordflow">if</font> (<a class="code" href="base.html#a22">instanceof</a>(src,<font class="keyword">const</font> StandardMatrixImpl)) 
00189     <font class="keywordflow">return</font> StandardMatrixImpl::operator=(narrow_cast&lt;const StandardMatrixImpl&gt;(src));
00190   <font class="keywordflow">else</font>
00191     <font class="keywordflow">return</font> MatrixImpl::operator=(src);
00192 }
00193 
00194 
00195 
<a name="l00196"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla17">00196</a> StandardMatrixImpl&amp; StandardMatrixImpl::operator=(<font class="keyword">const</font> StandardMatrixImpl&amp; src) <font class="keywordflow">throw</font>()
00197 { 
00198   <font class="keywordflow">if</font> (&amp;src != <font class="keyword">this</font>) {
00199     <font class="keywordflow">if</font> ((src.rows() != nr) || (src.columns() != nc)) {
00200       <font class="keyword">delete</font>[] m;
00201       nr = src.rows(); 
00202       nc = src.columns();
00203       m = <font class="keyword">new</font>(<font class="stringliteral">"StandardMatrixImpl::m reassigned"</font>) <a class="code" href="namespacebase.html#a5">Real</a>[nr*nc];
00204     }
00205     
00206     <a class="code" href="namespacebase.html#a68">copyMemory</a>(narrow_cast&lt;const StandardMatrixImpl&gt;(src).m,m,nr*nc);
00207   }
00208   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00209 }
00210 
00211 
<a name="l00212"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla18">00212</a> StandardMatrixImpl&amp; StandardMatrixImpl::operator=(<font class="keyword">const</font> <a class="code" href="namespacebase.html#a34">Vector</a>&amp; src) <font class="keywordflow">throw</font>()
00213 {
00214   <font class="keywordflow">if</font> ((nr != src.dimension()) || (nc != 1)) {
00215     <font class="keyword">delete</font>[] m;
00216     nc = src.dimension(); 
00217     nr = 1;
00218     m = <font class="keyword">new</font>(<font class="stringliteral">"StandardMatrixImpl::m reassigned from vec"</font>) <a class="code" href="namespacebase.html#a5">Real</a>[nr*nc];
00219   }
00220   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=1; c&lt;=nc; c++)
00221     m[offset(1,c)] = src[c];
00222   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00223 }
00224 
<a name="l00225"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla19">00225</a> <font class="keywordtype">bool</font> StandardMatrixImpl::operator==(<font class="keyword">const</font> MatrixImpl&amp; m1) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00226 {
00227   <font class="keywordflow">if</font> (&amp;m1 != <font class="keyword">this</font>) {
00228 
00229     <font class="keywordflow">if</font> (<a class="code" href="base.html#a22">instanceof</a>(m1,<font class="keyword">const</font> StandardMatrixImpl)) {
00230       
00231       <font class="keywordtype">bool</font> equal=<font class="keyword">true</font>;
00232       <a class="code" href="namespacebase.html#a5">Real</a>* s=narrow_cast&lt;const StandardMatrixImpl&gt;(m1).m;
00233       <a class="code" href="namespacebase.html#a5">Real</a>* t=m;
00234       <a class="code" href="namespacebase.html#a2">Int</a> i=nr*nc;
00235       <font class="keywordflow">while</font> (equal &amp;&amp; (i--&gt;0))
00236   equal = (*t++) == (*s++);
00237       <font class="keywordflow">return</font> equal;
00238     }
00239     <font class="keywordflow">else</font> 
00240       <font class="keywordflow">return</font> MatrixImpl::operator==(m1);
00241   }
00242   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00243 }
00244 
00245 
<a name="l00246"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla20">00246</a> <font class="keywordtype">bool</font> StandardMatrixImpl::equals(<font class="keyword">const</font> MatrixImpl&amp; m1) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00247 {
00248   <font class="keywordflow">if</font> (&amp;m1 != <font class="keyword">this</font>) {
00249 
00250     <font class="keywordflow">if</font> (<a class="code" href="base.html#a22">instanceof</a>(m1,<font class="keyword">const</font> StandardMatrixImpl)) {
00251    
00252       <font class="keywordtype">bool</font> equal=<font class="keyword">true</font>;
00253       <a class="code" href="namespacebase.html#a5">Real</a>* s=narrow_cast&lt;const StandardMatrixImpl&gt;(m1).m;
00254       <a class="code" href="namespacebase.html#a5">Real</a>* t=m;
00255       <a class="code" href="namespacebase.html#a2">Int</a> i=nr*nc;
00256       <font class="keywordflow">while</font> (equal &amp;&amp; (i--&gt;0))
00257   equal = <a class="code" href="namespacebase.html#a65">base::equals</a>(*t++,*s++);
00258       <font class="keywordflow">return</font> equal;
00259     }
00260     <font class="keywordflow">else</font> 
00261       <font class="keywordflow">return</font> MatrixImpl::equals(m1);
00262   }
00263   <font class="keywordflow">return</font> <font class="keyword">true</font>;
00264 }
00265 
00266 
<a name="l00267"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla21">00267</a> MatrixImpl&amp; StandardMatrixImpl::transpose()
00268 {
00269   <font class="keywordflow">if</font> (<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>==<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>) {
00270     <font class="comment">// faster in-place version for square matrices</font>
00271     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=1; r&lt;<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>; r++)
00272       <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=r+1; c&lt;=<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>; c++)
00273   <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImplb1">rcswap</a>(r,c);
00274   }
00275   <font class="keywordflow">else</font> {
00276     <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla0">StandardMatrixImpl</a> t(<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>,<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>);
00277     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=1; r&lt;=<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>; r++)
00278       <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=1; c&lt;=<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>; c++)
00279   t.m[<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImplb0">offset</a>(c,r)] = <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpln0">m</a>[<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImplb0">offset</a>(r,c)];
00280     *<font class="keyword">this</font> = t;
00281   }
00282   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00283 }
00284 
00285 
00286 
00287 
00288 <font class="comment">/*</font>
00289 <font class="comment">MatrixImpl SimpleMatrixSimpl::select(const Vector&amp; rowIndices,</font>
00290 <font class="comment">             const Vector&amp; colIndices) const throw(std::out_of_range)</font>
00291 <font class="comment">{</font>
00292 <font class="comment">  const Vector&amp; ri(rowIndices); // save typing</font>
00293 <font class="comment">  const Vector&amp; ci(colIndices);</font>
00294 <font class="comment"></font>
00295 <font class="comment">  if ((ri.dimension()==0) || (ci.dimension()==0))</font>
00296 <font class="comment">    throw std::out_of_range(Exception("index arrays can't be empty"));</font>
00297 <font class="comment"></font>
00298 <font class="comment">  StandardMatrixImpl s(ri.dimension(), ci.dimension());</font>
00299 <font class="comment">  for(Int r=1; r&lt;=ri.dimension(); r++)</font>
00300 <font class="comment">    for(Int c=1; c&lt;=ci.dimension(); c++) {</font>
00301 <font class="comment">      if (   (Int(ri[r]) &lt; 1) || (Int(ri[r]) &gt; nr) </font>
00302 <font class="comment">    || (Int(ci[c]) &lt; 1) || (Int(ci[c]) &gt; nc))</font>
00303 <font class="comment">  throw std::out_of_range(Exception("index out of range"));</font>
00304 <font class="comment">      s.e(r,c) = e(Int(ri[r]), Int(ci[c]));</font>
00305 <font class="comment">    }</font>
00306 <font class="comment">  return s;</font>
00307 <font class="comment">}</font>
00308 <font class="comment">*/</font>
00309 
<a name="l00310"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla22">00310</a> MatrixImpl&amp; StandardMatrixImpl::swapRows(<a class="code" href="namespacebase.html#a2">Int</a> i, <a class="code" href="namespacebase.html#a2">Int</a> j) <font class="keywordflow">throw</font>()
00311 {
00312   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=1; c&lt;=nc; c++)
00313     exchange(e(i,c),e(j,c));
00314   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00315 }
00316 
<a name="l00317"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla23">00317</a> MatrixImpl&amp; StandardMatrixImpl::swapCols(<a class="code" href="namespacebase.html#a2">Int</a> i, <a class="code" href="namespacebase.html#a2">Int</a> j) <font class="keywordflow">throw</font>()
00318 {
00319   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=1; r&lt;=nr; r++)
00320     exchange(e(r,i),e(r,j));
00321   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00322 }
00323 
00324 
00325 
<a name="l00326"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla24">00326</a> <font class="keywordtype">void</font> StandardMatrixImpl::getSubMatrix(<a class="code" href="namespacebase.html#a2">Int</a> row, <a class="code" href="namespacebase.html#a2">Int</a> col, <a class="code" href="namespacebase.html#a2">Int</a> rows, <a class="code" href="namespacebase.html#a2">Int</a> cols, MatrixImpl&amp; sm)<font class="keyword"> const</font>
00327 <font class="keyword"></font>{
00328   <font class="keywordflow">if</font> ((<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>+<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>-1 &gt; <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>) || (col+cols-1 &gt; <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>))
00329     <font class="keywordflow">throw</font> std::invalid_argument(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"Submatrix is out of bounds"</font>));
00330 
00331   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>; r&lt;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>+<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>; r++)
00332     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=col; c&lt;col+cols; c++)
00333       sm.e(r-<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>+1,c-col+1) = <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla14">e</a>(r,c);
00334 }
00335 
00336 
<a name="l00337"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla25">00337</a> <font class="keywordtype">void</font> StandardMatrixImpl::setSubMatrix(<a class="code" href="namespacebase.html#a2">Int</a> row, <a class="code" href="namespacebase.html#a2">Int</a> col, <font class="keyword">const</font> MatrixImpl&amp; sm)
00338 {
00339   <a class="code" href="namespacebase.html#a2">Int</a> <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a> = sm.rows();
00340   <a class="code" href="namespacebase.html#a2">Int</a> cols = sm.columns();
00341 
00342   <font class="keywordflow">if</font> ((<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>+<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>-1 &gt; <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln1">nr</a>) || (col+cols-1 &gt; <a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpln2">nc</a>))
00343     <font class="keywordflow">throw</font> std::invalid_argument(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"Submatrix is out of bounds"</font>));
00344 
00345   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> r=<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>; r&lt;<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>+<a class="code" href="classbase_1_1MatrixImpl.html#base_1_1StandardMatrixImpla31">rows</a>; r++)
00346     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> c=col; c&lt;col+cols; c++)
00347       <a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla14">e</a>(r,c) = sm.e(r-<a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla11">row</a>+1,c-col+1);
00348 }
00349 
00350 
00351 
00352 
00353 <font class="comment">// Operators</font>
00354 
00355 <font class="comment">// multiplication</font>
<a name="l00356"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla26">00356</a> MatrixImpl&amp; StandardMatrixImpl::operator*=(<font class="keyword">const</font> MatrixImpl&amp; m2) <font class="keywordflow">throw</font>()
00357 {
00358   StandardMatrixImpl r(nr,m2.columns());
00359 
00360   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> i=1; i&lt;=nr; i++)
00361     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> j=1; j&lt;=m2.columns(); j++) {
00362       r.e(i,j) = <a class="code" href="namespacebase.html#a5">Real</a>(0);
00363       <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> k=1; k&lt;=nc; k++)
00364   r.e(i,j) += e(i,k) * m2.e(k,j);
00365     }
00366   this-&gt;operator=(r);
00367 
00368   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00369 }
00370 
00371 <font class="comment">// addition</font>
<a name="l00372"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla27">00372</a> MatrixImpl&amp; StandardMatrixImpl::operator+=(<font class="keyword">const</font> MatrixImpl&amp; m2) <font class="keywordflow">throw</font>()
00373 {
00374   <font class="keywordflow">if</font> (<a class="code" href="base.html#a22">instanceof</a>(m2,<font class="keyword">const</font> StandardMatrixImpl)) {
00375     <a class="code" href="namespacebase.html#a5">Real</a>* m2m = narrow_cast&lt;const StandardMatrixImpl&gt;(m2).m;
00376 
00377     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;nr*nc; i++)
00378       m[i] += m2m[i];
00379   }
00380   <font class="keywordflow">else</font> 
00381     MatrixImpl::operator+=(m2);
00382 
00383   <font class="keywordflow">return</font> (*this);
00384 }
00385 
00386 <font class="comment">// subtration</font>
<a name="l00387"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla28">00387</a> MatrixImpl&amp; StandardMatrixImpl::operator-=(<font class="keyword">const</font> MatrixImpl&amp; m2) <font class="keywordflow">throw</font>()
00388 {
00389   <font class="keywordflow">if</font> (<a class="code" href="base.html#a22">instanceof</a>(m2,<font class="keyword">const</font> StandardMatrixImpl)) {
00390     <a class="code" href="namespacebase.html#a5">Real</a>* m2m = narrow_cast&lt;const StandardMatrixImpl&gt;(m2).m;
00391 
00392     <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;nr*nc; i++)
00393       m[i] -= m2m[i];
00394   }
00395   <font class="keywordflow">else</font>
00396     MatrixImpl::operator-=(m2);
00397 
00398   <font class="keywordflow">return</font> (*this);
00399 }
00400 
00401 <font class="comment">// Scalar multiplication</font>
<a name="l00402"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla29">00402</a> MatrixImpl&amp; StandardMatrixImpl::operator*=(<a class="code" href="namespacebase.html#a5">Real</a> s) <font class="keywordflow">throw</font>()
00403 { 
00404   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;nr*nc; i++)
00405     m[i] *= s;
00406   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00407 }
00408 
00409 <font class="comment">// Scalar division</font>
<a name="l00410"></a><a class="code" href="classbase_1_1StandardMatrixImpl.html#base_1_1StandardMatrixImpla30">00410</a> MatrixImpl&amp; StandardMatrixImpl::operator/=(<a class="code" href="namespacebase.html#a5">Real</a> s) <font class="keywordflow">throw</font>()
00411 {
00412   <font class="keywordflow">for</font>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;nr*nc; i++)
00413     m[i] /= s;
00414   <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00415 }
00416 
00417 
00418 
00419 
00420 
00421 
00422 
00423 
00424 
</pre></div><hr><address><small>Generated on Thu Aug 29 16:45:55 2002 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
