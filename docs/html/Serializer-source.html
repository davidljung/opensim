<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OpenSim: base/Serializer Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>base/Serializer</h1><a href="Serializer.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/****************************************************************************</span>
00002 <span class="comment">  Copyright (C)1996 David Jung &lt;opensim@pobox.com&gt;</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This program/file is free software; you can redistribute it and/or modify</span>
00005 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment">  (at your option) any later version.</span>
00008 <span class="comment">  </span>
00009 <span class="comment">  This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment">  GNU General Public License for more details. (http://www.gnu.org)</span>
00013 <span class="comment">  </span>
00014 <span class="comment">  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment">  along with this program; if not, write to the Free Software</span>
00016 <span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00017 <span class="comment">  </span>
00018 <span class="comment">  $Id: Serializer 1029 2004-02-11 20:45:54Z jungd $</span>
00019 <span class="comment">  $Revision: 1.11 $</span>
00020 <span class="comment">  $Date: 2004-02-11 15:45:54 -0500 (Wed, 11 Feb 2004) $</span>
00021 <span class="comment">  $Author: jungd $</span>
00022 <span class="comment"> </span>
00023 <span class="comment">****************************************************************************/</span>
00024 
00025 <span class="preprocessor">#ifndef _BASE_SERIALIZER_</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define _BASE_SERIALIZER_</span>
00027 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include &lt;<a class="code" href="base.html">base/base</a>&gt;</span>
00029 <span class="preprocessor">#include &lt;<a class="code" href="Serializable.html">base/Serializable</a>&gt;</span>
00030 <span class="preprocessor">#include &lt;<a class="code" href="Referenced.html">base/Referenced</a>&gt;</span>
00031 <span class="preprocessor">#include &lt;<a class="code" href="array.html">base/array</a>&gt;</span>
00032 <span class="preprocessor">#include &lt;<a class="code" href="ref.html">base/ref</a>&gt;</span>
00033 <span class="preprocessor">#include &lt;<a class="code" href="reflist.html">base/reflist</a>&gt;</span>
00034 <span class="preprocessor">#include &lt;<a class="code" href="serialization__error.html">base/serialization_error</a>&gt;</span>
00035 <span class="preprocessor">#include &lt;<a class="code" href="VFile.html">base/VFile</a>&gt;</span>
00036 
00037 <span class="preprocessor">#include &lt;<a class="code" href="Time.html">base/Time</a>&gt;</span>
00038 <span class="preprocessor">#include &lt;<a class="code" href="Vector3.html">base/Vector3</a>&gt;</span>
00039 <span class="preprocessor">#include &lt;<a class="code" href="Quat4.html">base/Quat4</a>&gt;</span>
00040 <span class="preprocessor">#include &lt;<a class="code" href="Orient.html">base/Orient</a>&gt;</span>
00041 <span class="preprocessor">#include &lt;<a class="code" href="Matrix3.html">base/Matrix3</a>&gt;</span>
00042 <span class="preprocessor">#include &lt;<a class="code" href="Matrix4.html">base/Matrix4</a>&gt;</span>
00043 <span class="preprocessor">#include &lt;<a class="code" href="Vector.html">base/Vector</a>&gt;</span>
00044 <span class="preprocessor">#include &lt;<a class="code" href="Matrix.html">base/Matrix</a>&gt;</span>
00045 
00046 
00047 <span class="preprocessor">#include &lt;iostream&gt;</span>
00048 <span class="preprocessor">#include &lt;list&gt;</span>
00049 
00050 
00051 <span class="keyword">namespace </span><a class="code" href="base_2Jamfile_8ft.html#a0">base</a> {
00052 
00053 <span class="keyword">class </span>Serializable;
00054 
00055 
<a name="l00056"></a><a class="code" href="classbase_1_1Serializer.html">00056</a> <span class="keyword">class </span><a class="code" href="classbase_1_1Serializer.html">Serializer</a> : <span class="keyword">public</span> <a class="code" href="classbase_1_1Object.html">Object</a>
00057 {
00058 <span class="keyword">public</span>:
<a name="l00059"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerw4">00059</a>   <span class="keyword">enum</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerw4">SerializerType</a> { Input=0, Output=1 };
00060   <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera0">Serializer</a>(SerializerType type);
00061   <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera0">Serializer</a>(SerializerType type, <a class="code" href="classbase_1_1ref.html">ref&lt;VFile&gt;</a> archive); 
00062   <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera0">Serializer</a>(SerializerType type, std::ios&amp; stream);
00063   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera3">~Serializer</a>();
00064 
<a name="l00065"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera7">00065</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera7">isOutput</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>; }     <span class="comment">///&lt; true is this is an output serialization stream</span>
<a name="l00066"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera8">00066</a> <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera8">isInput</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera7">isOutput</a>(); } <span class="comment">///&lt; true if this is an input serialization stream</span>
00067 <span class="comment"></span><span class="comment"></span>
00068 <span class="comment">  /** If follow is true (default) serialized references will cause the object being referenced to </span>
00069 <span class="comment">      be serialized (if it hasn't been already).  For complex data structures this recursive serialization</span>
00070 <span class="comment">      of objects (and hence object they reference in turn), may cause excessive stack usage.</span>
00071 <span class="comment">      If follow is false then the objects to which references refer will NOT be serialized.  It is then</span>
00072 <span class="comment">      up to the client to ensure that all referenced objects are ultimately serialized in the stream.</span>
00073 <span class="comment">      Upon destruction, the Serializer *may* throw an exception if there are outstanding references</span>
00074 <span class="comment">      to objects that have not been serialized.</span>
00075 <span class="comment">      Returns the previous value (which most serialize() methods should restore before returning)</span>
00076 <span class="comment">  */</span>
00077   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera6">followReferences</a>(<span class="keywordtype">bool</span> follow);
00078 
00079 <span class="comment"></span>
00080 <span class="comment">  /** The operator() method is overloaded for all types that can be serialized</span>
00081 <span class="comment">      (including classes that derive from Serializable, in which case their</span>
00082 <span class="comment">       serialize() method is called with *this Serializer).</span>
00083 <span class="comment">      For example: (assuming class B is-a Serialiable)</span>
00084 <span class="comment">      class A : public Serializable</span>
00085 <span class="comment">      {</span>
00086 <span class="comment">      public:</span>
00087 <span class="comment">        int  a;</span>
00088 <span class="comment">        Real b</span>
00089 <span class="comment">        ref&lt;B&gt; c;</span>
00090 <span class="comment">        B d;</span>
00091 <span class="comment">        std::list&lt;B&gt; e;</span>
00092 <span class="comment"></span>
00093 <span class="comment">        void serialize(Serializer&amp; s) { s(a)(b)(c)(d)(e); }</span>
00094 <span class="comment">      }</span>
00095 <span class="comment">      </span>
00096 <span class="comment">      The serialize() method will input or output (depending in the type of</span>
00097 <span class="comment">       the Serializer s) the values a &amp; b, will call c-&gt;serialize(s) if necessary</span>
00098 <span class="comment">       (for example, on Output, if the object *c hasn't already been serialized),</span>
00099 <span class="comment">       will call d.serialize() and also B::serialize(s) for each element of e.</span>
00100 <span class="comment"></span>
00101 <span class="comment">      NB: all serialization operator() methods have undefined behavior</span>
00102 <span class="comment">      for input streams that are exhausted, except char &amp; Byte, which return std::EOF</span>
00103 <span class="comment">   */</span>
00104 
00105   <span class="comment"></span>
00106 <span class="comment">  /// emit comments into the serialization stream.  Does nothing if not an output stream or the format doesn't support comments</span>
<a name="l00107"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera9">00107</a> <span class="comment"></span>  <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera9">comment</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; comment) { <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(comment); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
00108 
<a name="l00109"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerw5">00109</a>   <span class="keyword">enum</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerw5">Hint</a> { <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerw5base_1_1SimpleXMLSerializerw2">Indent</a>=0, <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerw5base_1_1SimpleXMLSerializerw3">Unindent</a>=1 };<span class="comment"></span>
00110 <span class="comment">  /// provide a hint.  The meaning is specific particular serializers and may be ignored/have no effect</span>
<a name="l00111"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera8">00111</a> <span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera8">hint</a>(<a class="code" href="namespacebase.html#a2">Int</a> h) { <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
00112 
00113 
00114   <span class="comment">// Serialization of simple types </span>
<a name="l00115"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">00115</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keywordtype">char</span>&amp; c, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)       { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(c, memberName); }
<a name="l00116"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera11">00116</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>&amp; c, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00117   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;char&amp;&gt;(c), memberName); }
00118 
<a name="l00119"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera12">00119</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="namespacebase.html#a0">Byte</a>&amp; b, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)       { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(b, memberName); }
<a name="l00120"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera13">00120</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a0">Byte</a>&amp; b, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00121   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;Byte&amp;&gt;(b), memberName); }
00122 
<a name="l00123"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera14">00123</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keywordtype">bool</span>&amp; b, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)       { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(b, memberName); }
<a name="l00124"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera15">00124</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span>&amp; b, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00125   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;bool&amp;&gt;(b), memberName); }
00126 
<a name="l00127"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera16">00127</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="namespacebase.html#a1">SInt</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)       { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(i, memberName); }
<a name="l00128"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera17">00128</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a1">SInt</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00129   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;SInt&amp;&gt;(i), memberName); }
00130 
<a name="l00131"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera18">00131</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="namespacebase.html#a2">Int</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)        { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(i, memberName); }
<a name="l00132"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera19">00132</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a2">Int</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)  
00133   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;Int&amp;&gt;(i), memberName); }
00134 
<a name="l00135"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera20">00135</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="namespacebase.html#a3">LInt</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)       { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(i, memberName); }
<a name="l00136"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera21">00136</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a3">LInt</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00137   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;LInt&amp;&gt;(i), memberName); }
00138 
<a name="l00139"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera22">00139</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="namespacebase.html#a5">Real</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)       { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(r, memberName); }
<a name="l00140"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera23">00140</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a5">Real</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00141   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;Real&amp;&gt;(r), memberName); }
00142 
00143 
00144   <span class="comment">// Serialization of light weight (non-Serializable) composite types </span>
<a name="l00145"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera24">00145</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="namespacebase.html#a4">String</a>&amp; s, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)     { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(s, memberName); }
<a name="l00146"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera25">00146</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; s, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00147   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;String&amp;&gt;(s), memberName); }
00148 
<a name="l00149"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera26">00149</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Time.html">Time</a>&amp; t, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00150   { t.<a class="code" href="classbase_1_1Time.html#base_1_1Timea15">serialize</a>(*<span class="keyword">this</span>); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00151"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera27">00151</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Time.html">Time</a>&amp; t, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00152   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Time&amp;&gt;(t), memberName); }
00153 
<a name="l00154"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera28">00154</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Vector3.html">Vector3</a>&amp; v, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00155   { v.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a35">serialize</a>(*<span class="keyword">this</span>); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00156"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera29">00156</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">Vector3</a>&amp; v, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00157   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Vector3&amp;&gt;(v), memberName); }
00158 
<a name="l00159"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera30">00159</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Quat4.html">Quat4</a>&amp; q, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00160   { q.<a class="code" href="classbase_1_1Quat4.html#base_1_1Quat4a38">serialize</a>(*<span class="keyword">this</span>); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00161"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera31">00161</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Quat4.html">Quat4</a>&amp; q, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00162   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Quat4&amp;&gt;(q), memberName); }
00163 
<a name="l00164"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera32">00164</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Orient.html">Orient</a>&amp; o, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00165   { o.<a class="code" href="classbase_1_1Orient.html#base_1_1Orienta37">serialize</a>(*<span class="keyword">this</span>); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00166"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera33">00166</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Orient.html">Orient</a>&amp; o, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00167   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Orient&amp;&gt;(o), memberName); }
00168 
<a name="l00169"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera34">00169</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Matrix3.html">Matrix3</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00170   { m.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a38">serialize</a>(*<span class="keyword">this</span>); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00171"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera35">00171</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">Matrix3</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00172   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Matrix3&amp;&gt;(m), memberName); }
00173 
<a name="l00174"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera36">00174</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Matrix4.html">Matrix4</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00175   { m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a47">serialize</a>(*<span class="keyword">this</span>); <span class="keywordflow">return</span> *<span class="keyword">this</span>; }
<a name="l00176"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera37">00176</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix4.html">Matrix4</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00177   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Matrix4&amp;&gt;(m), memberName); }
00178 
00179   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1vector.html">Vector</a>&amp; v, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>);
<a name="l00180"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera39">00180</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1vector.html">Vector</a>&amp; v, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00181   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Vector&amp;&gt;(v), memberName); }
00182 
00183   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1matrix.html">Matrix</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>);
<a name="l00184"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera41">00184</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1matrix.html">Matrix</a>&amp; m, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00185   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(const_cast&lt;Matrix&amp;&gt;(m), memberName); }
00186     
00187 
00188 
00189   <span class="comment">// serialization of references complex types (derived from Serializable),</span>
00190   <span class="comment">//  references (ref&lt;T&gt;, T derived from Serializable), and supported containers</span>
00191   <span class="comment">//  (e.g. array)</span>
00192 
<a name="l00193"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera42">00193</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1Serializable.html">Serializable</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(r, memberName); }
<a name="l00194"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera43">00194</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Serializable.html">Serializable</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>) 
00195   { <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString)); <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(const_cast&lt;Serializable&amp;&gt;(r), memberName); }
00196 
00197 
00198   <span class="comment">// ref&lt;T&gt;</span>
00199   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00200"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera44">00200</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;T&gt;</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00201   {
00202     T* p = <a class="code" href="namespacebase.html#a163">GetImplRef</a>(r);
00203     
00204     <a class="code" href="classbase_1_1Serializable.html">Serializable</a>* sp = 0;
00205     <span class="keywordflow">if</span> (p!=0) {
00206       <span class="keywordflow">if</span> (!<a class="code" href="base.html#a25">instanceof</a>(*p,<a class="code" href="classbase_1_1Serializable.html">Serializable</a>))
00207         <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(<span class="stringliteral">"can only archive references to Serializable derived classes (ref&lt;Serializable&gt;)"</span>));
00208       sp = dynamic_cast&lt;Serializable*&gt;(p);
00209     }
00210 
00211     <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) {
00212       <a class="code" href="classbase_1_1Serializable_1_1SerializableDerivedInstantiator.html">Serializable::SerializableDerivedInstantiator&lt;T&gt;</a> i;
00213       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb18">serializePointer</a>(sp,(sp==0)?&amp;i:0, memberName);
00214       <a class="code" href="base.html#a19">Assert</a>(sp);
00215       p = dynamic_cast&lt;T*&gt;(sp);
00216       <a class="code" href="namespacebase.html#a164">Reset</a>(r,p);  
00217     }
00218     <span class="keywordflow">else</span>
00219       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb18">serializePointer</a>(sp,0, memberName);
00220 
00221     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00222   }
00223 
00224   <span class="comment">// ref&lt;T&gt; where T is a (possible abstract) base of the subclass being serialized</span>
00225   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00226"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera52">00226</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera52">baseRef</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;T&gt;</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00227   {
00228     T* p = <a class="code" href="namespacebase.html#a163">GetImplRef</a>(r);
00229     
00230     <a class="code" href="classbase_1_1Serializable.html">Serializable</a>* sp = 0;
00231     <span class="keywordflow">if</span> (p!=0) {
00232       <span class="keywordflow">if</span> (!<a class="code" href="base.html#a25">instanceof</a>(*p,<a class="code" href="classbase_1_1Serializable.html">Serializable</a>))
00233         <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(<span class="stringliteral">"can only archive references to Serializable derived classes (ref&lt;Serializable&gt;)"</span>));
00234       sp = dynamic_cast&lt;Serializable*&gt;(p);
00235     }
00236 
00237     <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) {
00238       <span class="comment">// can't utilize an existing instance it may not be the correct subclass</span>
00239       r = <a class="code" href="classbase_1_1ref.html">ref&lt;T&gt;</a>();
00240       sp = 0; 
00241       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb18">serializePointer</a>(sp,0, memberName,<span class="keyword">true</span>);
00242       <a class="code" href="base.html#a19">Assert</a>(sp);
00243       p = dynamic_cast&lt;T*&gt;(sp);
00244       <a class="code" href="namespacebase.html#a164">Reset</a>(r,p);  
00245     }
00246     <span class="keywordflow">else</span>
00247       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb18">serializePointer</a>(sp,0, memberName, <span class="keyword">true</span>);
00248 
00249     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00250   }
00251 
00252 
00253   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00254"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera45">00254</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1ref.html">ref&lt;T&gt;</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00255   {
00256     <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>)
00257       <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(<span class="stringliteral">"can't input to a const ref&lt;&gt;"</span>));
00258 
00259     T* p = <a class="code" href="namespacebase.html#a163">GetImplRef</a>(r);
00260 
00261     <a class="code" href="classbase_1_1Serializable.html">Serializable</a>* sp = 0;
00262     <span class="keywordflow">if</span> (p != 0) {
00263       <span class="keywordflow">if</span> (!<a class="code" href="base.html#a25">instanceof</a>(*p,<a class="code" href="classbase_1_1Serializable.html">Serializable</a>))
00264         <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(<span class="stringliteral">"can only archive references to Serializable derived classes (ref&lt;Serializable&gt;)"</span>));
00265       sp = dynamic_cast&lt;Serializable*&gt;(p);
00266     }
00267     <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb18">serializePointer</a>(sp,0, memberName);
00268     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00269   }
00270 
00271 
00272   <span class="comment">// array</span>
00273   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00274"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera46">00274</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1array.html">array&lt;T&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00275   {
00276     <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"begin array "</span>)+memberName);
00277     <a class="code" href="namespacebase.html#a2">Int</a> size = a.<a class="code" href="classbase_1_1array.html#base_1_1arraya14">size</a>();
00278     <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(size, <span class="stringliteral">"size"</span>);
00279     <span class="keywordflow">for</span>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;size; i++)
00280       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(a.<a class="code" href="classbase_1_1array.html#base_1_1arraya13">at</a>(i));
00281     <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"end array "</span>)+memberName);
00282     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00283   }
00284 
00285   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00286"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera47">00286</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1array.html">array&lt;T&gt;</a>&amp; a, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00287   {
00288     <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>)
00289       <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString));
00290 
00291     <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"begin array "</span>)+memberName);
00292     <a class="code" href="namespacebase.html#a2">Int</a> size = a.<a class="code" href="classbase_1_1array.html#base_1_1arraya14">size</a>();
00293     <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(size, <span class="stringliteral">"size"</span>);
00294     <span class="keywordflow">for</span>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;a.<a class="code" href="classbase_1_1array.html#base_1_1arraya14">size</a>(); i++)
00295       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(a[i]);
00296     <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"end array "</span>)+memberName);
00297     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00298   }
00299 
00300   <span class="comment">// std::list&lt;T&gt;</span>
00301   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00302"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera48">00302</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(std::list&lt;T&gt;&amp; l, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00303   {
00304     <span class="keywordflow">if</span> (<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) {
00305       <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"begin list "</span>)+memberName);
00306       <a class="code" href="namespacebase.html#a2">Int</a> size = l.size();
00307       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(size, <span class="stringliteral">"size"</span>);
00308       <span class="keyword">typename</span> std::list&lt;T&gt;<a class="code" href="classstd_1_1iterator.html">::iterator</a> i = l.begin();
00309       <span class="keyword">typename</span> std::list&lt;T&gt;<a class="code" href="classstd_1_1iterator.html">::iterator</a> end = l.end();
00310       <span class="keywordflow">while</span> (i != end) {
00311         <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(*i);
00312         ++i;
00313       }
00314       <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"end list "</span>)+memberName);
00315     }
00316     <span class="keywordflow">else</span> {
00317       l.clear();
00318       <a class="code" href="namespacebase.html#a2">Int</a> size;
00319       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(size, <span class="stringliteral">"size"</span>);
00320       <span class="keywordflow">if</span> (size &gt; 0) {
00321         T e;
00322         <span class="keywordflow">for</span>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;size; i++) {
00323           <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(e);
00324           l.push_back( e );
00325         }
00326       }
00327     }
00328 
00329     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00330   }
00331 
00332   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00333"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera49">00333</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> std::list&lt;T&gt;&amp; a, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00334   {
00335     <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>)
00336       <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString));
00337     <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const_cast</span>&lt;std::list&lt;T&gt;&amp;&gt;(a), memberName);
00338   }
00339 
00340 
00341   <span class="comment">// reflist&lt;T&gt;</span>
00342   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00343"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera50">00343</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<a class="code" href="classbase_1_1reflist.html">reflist&lt;T&gt;</a>&amp; l, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00344   {
00345     <span class="keywordflow">if</span> (<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>) {
00346       <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"begin reflist "</span>)+memberName);
00347       <a class="code" href="namespacebase.html#a2">Int</a> size = l.<a class="code" href="classbase_1_1reflist.html#base_1_1reflista13">size</a>();
00348       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(size, <span class="stringliteral">"size"</span>);
00349       <span class="keyword">typename</span> <a class="code" href="classbase_1_1reflist.html">reflist&lt;T&gt;</a><a class="code" href="classstd_1_1iterator.html">::iterator</a> i = l.<a class="code" href="classbase_1_1reflist.html#base_1_1reflista0">begin</a>();
00350       <span class="keyword">typename</span> <a class="code" href="classbase_1_1reflist.html">reflist&lt;T&gt;</a><a class="code" href="classstd_1_1iterator.html">::iterator</a> end = l.<a class="code" href="classbase_1_1reflist.html#base_1_1reflista3">end</a>();
00351       <span class="keywordflow">while</span> (i != end) {
00352         <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(*i);
00353         ++i;
00354       }
00355       <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<a class="code" href="namespacebase.html#a4">String</a>(<span class="stringliteral">"end reflist "</span>)+memberName);
00356     }
00357     <span class="keywordflow">else</span> {
00358       l.<a class="code" href="classbase_1_1reflist.html#base_1_1reflista30">clear</a>();
00359       <a class="code" href="namespacebase.html#a2">Int</a> size;
00360       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(size, <span class="stringliteral">"size"</span>);
00361       <span class="keywordflow">if</span> (size &gt; 0) {
00362         <span class="keywordflow">for</span>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;size; i++) {
00363           <a class="code" href="classbase_1_1ref.html">ref&lt;T&gt;</a> e(0);
00364           <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(e);
00365           l.<a class="code" href="classbase_1_1reflist.html#base_1_1reflista26">push_back</a>( e );
00366         }
00367       }
00368     }
00369 
00370     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00371   }
00372 
00373   <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
<a name="l00374"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera51">00374</a>   <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1reflist.html">reflist&lt;T&gt;</a>&amp; l, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName = <span class="stringliteral">""</span>)
00375   {
00376     <span class="keywordflow">if</span> (!<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>)
00377       <span class="keywordflow">throw</span> <a class="code" href="classbase_1_1serialization__error.html">serialization_error</a>(<a class="code" href="base.html#a15">Exception</a>(inputToConstErrorString));
00378     <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(<span class="keyword">const_cast</span>&lt;<a class="code" href="classbase_1_1reflist.html">reflist&lt;T&gt;</a>&amp;&gt;(l), memberName);
00379   }
00380 
00381 
00382   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera52">flush</a>() = 0;
00383 
00384 <span class="keyword">protected</span>:  
<a name="l00385"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb0">00385</a>   <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializera0">Serializer</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; s) : <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>(s.<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>), <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp4">follow</a>(s.<a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp4">follow</a>), aborted(s.aborted) {}
00386 
<a name="l00387"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializert0">00387</a>   <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="namespacebase.html#a4">String</a> inputToConstErrorString;
00388 
00389   <span class="comment">// helpers</span>
<a name="l00390"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb17">00390</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb17">serializeReferenceIndex</a>(<a class="code" href="namespacebase.html#a2">Int</a>&amp; index)
00391     { <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializera10">operator()</a>(index,<span class="stringliteral">"refindex"</span>); }
00392   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb18">serializePointer</a>(<a class="code" href="classbase_1_1Serializable.html">Serializable</a>*&amp; p, <a class="code" href="classbase_1_1Serializable_1_1SerializableInstantiator.html">Serializable::SerializableInstantiator</a>* i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName, <span class="keywordtype">bool</span> forceTypeSerialization = <span class="keyword">false</span>);
00393 
00394   <span class="keywordtype">void</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb19">abort</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; exceptionString); <span class="comment">// flags the serialization as aborted and throws an exception</span>
00395 
00396 
00397   <span class="comment">// specialized Serializers need only implement these</span>
00398   <span class="comment">//  (for convenience only the non-const parameter versions are</span>
00399   <span class="comment">//   required.  This means that for Output type serializers,</span>
00400   <span class="comment">//   these functions should *not* modify the parameter.  The</span>
00401   <span class="comment">//   parameter has had its constness cast away before being passed)</span>
00402   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<span class="keywordtype">char</span>&amp; c, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00403   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="namespacebase.html#a0">Byte</a>&amp; b, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00404   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<span class="keywordtype">bool</span>&amp; b, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00405   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="namespacebase.html#a1">SInt</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00406   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="namespacebase.html#a2">Int</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00407   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="namespacebase.html#a3">LInt</a>&amp; i, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00408   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="namespacebase.html#a4">String</a>&amp; s, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00409   <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="namespacebase.html#a5">Real</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00410 
00411 
<a name="l00412"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5">00412</a>   <span class="keyword">enum</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5">TypeModifier</a> { <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5base_1_1SimpleXMLSerializerx0">UnknownType</a>          = 0,
00413                       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5base_1_1SimpleXMLSerializerx1">ObjectType</a>           = 1,
00414                       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5base_1_1SimpleXMLSerializerx2">ReferencedObjectType</a> = 2,
00415                       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5base_1_1SimpleXMLSerializerx3">ObjectReferenceType</a>  = 3,
00416                       <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerx5base_1_1SimpleXMLSerializerx4">InvalidType</a>          = 4 };<span class="comment"></span>
00417 <span class="comment">  ///  serializes object or reference header</span>
00418 <span class="comment"></span><span class="comment">  /**</span>
00419 <span class="comment">   *   Typically serializes the object or reference type (at minimum a flag indicating if a referenced object is present in the</span>
00420 <span class="comment">   *   stream, or just an object reference).  Called just before an object or reference is serialized (by serialize(Serializable&amp;) </span>
00421 <span class="comment">   *   or serializePointer() ).</span>
00422 <span class="comment">   *    </span>
00423 <span class="comment">   *   @param      typeName      Object type name as returned from typeid().name(). </span>
00424 <span class="comment">   *                             For output, the type of the object is passed.  In the case of referenced objects</span>
00425 <span class="comment">   *                             it shound't be the pointer or reference type, just the referenced object type.</span>
00426 <span class="comment">   *                             For input streams, the expected type is passed, or the empty string if the object type</span>
00427 <span class="comment">   *                             to be read is unknown (if, for example, the serialization format doesn't include type information)</span>
00428 <span class="comment">   *                             If the serialization format does contain the object type information, it is returned, otherwise</span>
00429 <span class="comment">   *                             the parameter is unaltered.</span>
00430 <span class="comment">   *</span>
00431 <span class="comment">   *   @param      typeModifier  Modifies typeName to indicate unreferencable objects, referenced objects and object references.</span>
00432 <span class="comment">   *                             For output, the value ObjectType is passed for single instance objects.  For referenced objects,</span>
00433 <span class="comment">   *                             ReferencedObjectType is passed if the object itself will subsequently be serialized,</span>
00434 <span class="comment">   *                             or ObjectReferenceType if subsequently only a reference to the object (elsewhere in</span>
00435 <span class="comment">   *                             the stream) will be serialized.</span>
00436 <span class="comment">   *                             For input, the values passed are as for output, except that if it is unknown if</span>
00437 <span class="comment">   *                             a referenced object or just a reference will subsequently be read, UnknownType is passed,</span>
00438 <span class="comment">   *                             and either the value ReferencedObjectType or ObjectReferenceType will be returned.</span>
00439 <span class="comment">   *</span>
00440 <span class="comment">   *   @param      memberName    An optional name for the reference being serialized.  This must be the same on input</span>
00441 <span class="comment">   *                             as was supplied on output.</span>
00442 <span class="comment">   *</span>
00443 <span class="comment">   *   @param      forceTypeSerialization Usually the type of object being input can be deduced from the type of</span>
00444 <span class="comment">   *                                      the reference.  However, when serializing derived classes via a reference</span>
00445 <span class="comment">   *                                      to a base class, it is not possible to determine which derived class to</span>
00446 <span class="comment">   *                                      instantiate on input unless the type is stored in the serialization stream.</span>
00447 <span class="comment">   *                                      For Serializers that don't usually store the referenced object type on output,</span>
00448 <span class="comment">   *                                      this parameter is used to force them to do so.</span>
00449 <span class="comment">   *</span>
00450 <span class="comment">   *   @return     For output, the parameter typeModifier is returned.  For input, one of ObjectType, ReferencedObjectType or ObjectReferenceType is returned.</span>
00451 <span class="comment">   *   @exception  serialization_error if unexpected input is found.</span>
00452 <span class="comment">   *</span>
00453 <span class="comment">   * Note that as the strings returned by typeid().name() are not portable accross compilers, they shouldn't be</span>
00454 <span class="comment">   *      embedded into serialization streams.  Use base::className(typeid()) to obtain a portable type string.</span>
00455 <span class="comment">   */</span>
00456   <span class="keyword">virtual</span> TypeModifier <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb12">preSerializeObject</a>(<a class="code" href="namespacebase.html#a4">String</a>&amp; typeName, TypeModifier typeModifier, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName, <span class="keywordtype">bool</span> forceTypeSerialization = <span class="keyword">false</span>) = 0;
00457 <span class="comment"></span>
00458 <span class="comment">  /// serialize an object or reference 'footer'</span>
00459 <span class="comment"></span><span class="comment">  /** Called just after an object or reference has been serialized (by serialize(Serializable&amp;) or serializePointer() ). */</span>
00460   <span class="keyword">virtual</span> <span class="keywordtype">void</span>         <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb13">postSerializeObject</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName) = 0;
00461 
00462 <span class="comment"></span>
00463 <span class="comment">  /// only override this to re-implement </span>
00464 <span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Serializer.html">Serializer</a>&amp; <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb4">serialize</a>(<a class="code" href="classbase_1_1Serializable.html">Serializable</a>&amp; r, <span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; memberName);
00465 <span class="comment"></span>
00466 <span class="comment">  /// override this if the serialization format supports comments</span>
<a name="l00467"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">00467</a> <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1Serializerb15">serializeComment</a>(<span class="keyword">const</span> <a class="code" href="namespacebase.html#a4">String</a>&amp; comment) {}
00468 
00469 
00470 
00471 
<a name="l00472"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">00472</a>   <span class="keywordtype">bool</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp3">output</a>;
<a name="l00473"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp4">00473</a>   <span class="keywordtype">bool</span> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp4">follow</a>;
<a name="l00474"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp5">00474</a>   <span class="keywordtype">bool</span> aborted;
00475 
00476   <a class="code" href="namespacebase.html#a2">Int</a> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerb21">ptrIndex</a>(<a class="code" href="classbase_1_1Serializable.html">Serializable</a>* p);
00477 
<a name="l00478"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp6">00478</a>   <a class="code" href="classbase_1_1array.html">array&lt;Serializable*&gt;</a> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp6">ptrs</a>;
<a name="l00479"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp7">00479</a>   <a class="code" href="classbase_1_1array.html">array&lt;bool&gt;</a>          <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp7">serialized</a>;
<a name="l00480"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp8">00480</a>   <a class="code" href="namespacebase.html#a2">Int</a> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp8">serializePointerRecursionDepth</a>;
<a name="l00481"></a><a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp9">00481</a>   <a class="code" href="namespacebase.html#a2">Int</a> <a class="code" href="classbase_1_1Serializer.html#base_1_1SimpleXMLSerializerp9">depthAtFollowDisable</a>; <span class="comment">// serializePointerRecursionDepth value when follow was last set false (follow pointer's only one level below)</span>
00482 };
00483 
00484 
00485 } <span class="comment">// base</span>
00486 
00487 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Jul 29 15:56:13 2004 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
