<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OpenSim: robot/sim/SimulatedKinematicChain Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>robot/sim/SimulatedKinematicChain</h1><a href="SimulatedKinematicChain.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* **-*-c++-*-**************************************************************</span>
00002 <span class="comment">  Copyright (C)2002 David Jung &lt;opensim@pobox.com&gt;</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This program/file is free software; you can redistribute it and/or modify</span>
00005 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment">  (at your option) any later version.</span>
00008 <span class="comment">        </span>
00009 <span class="comment">  This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment">  GNU General Public License for more details. (http://www.gnu.org)</span>
00013 <span class="comment">        </span>
00014 <span class="comment">  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment">  along with this program; if not, write to the Free Software</span>
00016 <span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00017 <span class="comment"></span>
00018 <span class="comment">  $Id: SimulatedKinematicChain 1033 2004-02-11 20:47:52Z jungd $</span>
00019 <span class="comment">  $Revision: 1.2 $</span>
00020 <span class="comment">  $Date: 2004-02-11 15:47:52 -0500 (Wed, 11 Feb 2004) $</span>
00021 <span class="comment">  $Author: jungd $</span>
00022 <span class="comment"> </span>
00023 <span class="comment">****************************************************************************/</span>
00024 
00025 <span class="preprocessor">#ifndef _ROBOT_SIM_SIMULATEDKINEMATICCHAIN_</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#define _ROBOT_SIM_SIMULATEDKINEMATICCHAIN_</span>
00027 <span class="preprocessor"></span>
00028 <span class="preprocessor">#include &lt;<a class="code" href="sim.html">robot/sim/sim</a>&gt;</span>
00029 
00030 <span class="preprocessor">#include &lt;<a class="code" href="ReferencedObject.html">base/ReferencedObject</a>&gt;</span>
00031 <span class="preprocessor">#include &lt;<a class="code" href="Dimension3.html">base/Dimension3</a>&gt;</span>
00032 <span class="preprocessor">#include &lt;<a class="code" href="Externalizable.html">base/Externalizable</a>&gt;</span>
00033 
00034 <span class="preprocessor">#include &lt;<a class="code" href="SolidSystem.html">physics/SolidSystem</a>&gt;</span>
00035 <span class="preprocessor">#include &lt;<a class="code" href="Solid.html">physics/Solid</a>&gt;</span>
00036 <span class="preprocessor">#include &lt;<a class="code" href="SpatialGroup.html">physics/SpatialGroup</a>&gt;</span>
00037 <span class="preprocessor">#include &lt;<a class="code" href="CollidableProvider.html">physics/CollidableProvider</a>&gt;</span>
00038 <span class="preprocessor">#include &lt;<a class="code" href="CollisionDetector.html">physics/CollisionDetector</a>&gt;</span>
00039 <span class="preprocessor">#include &lt;<a class="code" href="CollisionResponseHandler.html">physics/CollisionResponseHandler</a>&gt;</span>
00040 
00041 <span class="preprocessor">#include &lt;<a class="code" href="KinematicChain.html">robot/KinematicChain</a>&gt;</span>
00042 
00043 
00044 <span class="keyword">namespace </span><a class="code" href="robot_2Jamfile_8ft.html#a0">robot</a> {
00045 <span class="keyword">namespace </span><a class="code" href="robot_2Jamfile_8ft.html#a3">sim</a> {
00046 <span class="comment"></span>
00047 <span class="comment">/**</span>
00048 <span class="comment"> * Base for concrete classes that simulate kinematic chains</span>
00049 <span class="comment"> *  - such as manipulators and tools </span>
00050 <span class="comment"> */</span>
<a name="l00051"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html">00051</a> <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html">SimulatedKinematicChain</a> : <span class="keyword">public</span> <a class="code" href="physics_2Jamfile_8ft.html#a0">physics</a>::Spatial, <span class="keyword">public</span> <a class="code" href="physics_2Jamfile_8ft.html#a0">physics</a>::CollidableProvider, <span class="keyword">public</span> <a class="code" href="base_2Jamfile_8ft.html#a0">base</a>::Externalizable
00052 {
00053 <span class="keyword">public</span>:
<a name="l00054"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina0">00054</a>   <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina0">SimulatedKinematicChain</a>(<span class="keywordtype">bool</span> dynamic=<span class="keyword">true</span>) 
00055     : dynamic(dynamic) {}
<a name="l00056"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina1">00056</a>   <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina0">SimulatedKinematicChain</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem, <span class="keywordtype">bool</span> dynamic=<span class="keyword">true</span>) 
00057     : solidSystem(solidSystem), dynamic(dynamic) {}
00058   
00059 
<a name="l00060"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina2">00060</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina2">setDynamic</a>(<span class="keywordtype">bool</span> enabled) { dynamic = enabled; }
00061   
<a name="l00062"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina3">00062</a>   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina3">setSolidSystem</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem)
00063     { this-&gt;solidSystem = solidSystem; }
00064   <span class="comment"></span>
00065 <span class="comment">  /// Set the force (torque for revolute joints) of joint j (first joint j=1)</span>
00066 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina4">setJointForce</a>(Int j, Real f) = 0;
00067 <span class="comment"></span>
00068 <span class="comment">  /// Set the velocity (ang. velocity for revolute joints) of joint j (first joint j=1)</span>
00069 <span class="comment"></span><span class="comment">  /** NB: As the simulation is force controlled, this will set the target velocity */</span>
00070   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina5">setJointVel</a>(Int j, Real v, Real maxForce=10.0) = 0;
00071   
00072   <span class="comment"></span>
00073 <span class="comment">  /// Set the position (angle for revolute joints) of joint j (first joint j=1)</span>
00074 <span class="comment"></span><span class="comment">  /** NB: This will instantaneously move the joint to the specified angle - which obviously</span>
00075 <span class="comment">   *      is not physically realistic.  Consequently, for dynamic simulations, this can</span>
00076 <span class="comment">   *      cause large forces in the system and possibly numerical instability in the</span>
00077 <span class="comment">   *      simulation.  It is intended for non-dynamic simulations. </span>
00078 <span class="comment">   *  NB: the angle is relative to the theta home position.</span>
00079 <span class="comment">   */</span>
00080   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina6">setJointPos</a>(Int j, Real p) = 0;
00081    
00082    <span class="comment"></span>
00083 <span class="comment">  /// Get the current theta* angle (revolute) or position d (prismatic) of the joint</span>
00084 <span class="comment"></span><span class="comment">  /** *NB: the angle is relative to the theta home position. */</span> 
00085   <span class="keyword">virtual</span> Real <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina7">getJointPos</a>(Int j) <span class="keyword">const</span> = 0;
00086 <span class="comment"></span>
00087 <span class="comment">  /// Get the current joint velocity (ang. velocity for revolute joints)</span>
00088 <span class="comment"></span>  <span class="keyword">virtual</span> Real <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina8">getJointVel</a>(Int j) <span class="keyword">const</span> = 0;
00089 
00090 
00091 
00092   <span class="comment">// Proximity sensor methods</span>
00093   
<a name="l00094"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedTools0">00094</a>   <span class="keyword">static</span> <span class="keyword">const</span> Real <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedTools0">maxDist</a>;
00095     <span class="comment"></span>
00096 <span class="comment">  /// get distance to closest object detected by proximity sensors on the link</span>
00097 <span class="comment"></span>  <span class="keyword">virtual</span> Real    <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina9">getClosestObjectDistance</a>(Int link) <span class="keyword">const</span> = 0;
00098   <span class="comment"></span>
00099 <span class="comment">  /// get the direction vector to the closest object detected by proximity sensors on the link</span>
00100 <span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classbase_1_1Vector3.html">Vector3</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina10">getClosestObjectDirection</a>(Int link) <span class="keyword">const</span> = 0;
00101   <span class="comment"></span>
00102 <span class="comment">  /// get the distance along the link x-axis of the proximity sensor that detected the closest object to the link</span>
00103 <span class="comment"></span>  <span class="keyword">virtual</span> Real    <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina11">getClosestObjectSensorPosition</a>(Int link) <span class="keyword">const</span> = 0;
00104 
00105 
00106 <span class="keyword">protected</span>:
<a name="l00107"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb0">00107</a>   <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChaina0">SimulatedKinematicChain</a>(<span class="keyword">const</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html">SimulatedKinematicChain</a>&amp; kc) { <a class="code" href="debugtools.html#a12">Unimplemented</a>; }
00108 
<a name="l00109"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp8">00109</a>   <a class="code" href="classrobot_1_1KinematicChain.html">KinematicChain</a> chain;
<a name="l00110"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp9">00110</a>   <a class="code" href="classbase_1_1ref.html">ref&lt;physics::SolidSystem&gt;</a> solidSystem;
00111 <span class="comment"></span>
00112 <span class="comment">  /// true for a dynamic simulation, fasle for static (no force/torque or velocity control, just position control)</span>
<a name="l00113"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp10">00113</a> <span class="comment"></span>  <span class="keywordtype">bool</span> dynamic; 
00114 <span class="comment"></span>
00115 <span class="comment">  /// construct an approximation of the manipulator from the D-H parameters (best we can do) </span>
00116 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb1">construct</a>(<span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; initialPosition, <span class="keyword">const</span> <a class="code" href="classbase_1_1Orient.html">base::Orient</a>&amp; initialOrientation) = 0;
00117 <span class="comment"></span>
00118 <span class="comment">  /// compute the dimensions of each link's Solid based on the KinematicChain</span>
00119 <span class="comment">  ///  and fill in linkLengths[1..dof]</span>
00120 <span class="comment"></span>  <span class="keyword">virtual</span> array&lt;base::Dimension3&gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolb8">computeLinkDimensions</a>(<span class="keyword">const</span> array&lt;Real&gt;&amp; linkRadii);
00121   
00122   <span class="comment">// used to hold temporary transformation result during computation for placement of links</span>
<a name="l00123"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html">00123</a>   <span class="keyword">struct </span><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html">TransformInfo</a> {
<a name="l00124"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo0">00124</a>     <a class="code" href="classbase_1_1Transform.html">base::Transform</a> <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo0">mountTransform</a>; <span class="comment">///&lt; transform from mount point to world frame  </span>
<a name="l00125"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo1">00125</a> <span class="comment"></span>    array&lt;base::Transform&gt; A;       <span class="comment">///&lt; transform from link l frame into link l-1 frame </span>
<a name="l00126"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo2">00126</a> <span class="comment"></span>    array&lt;base::Transform&gt; T;       <span class="comment">///&lt; accumulated transformations for each link (transforms from link l frame to mount frame)</span>
<a name="l00127"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo3">00127</a> <span class="comment"></span>    array&lt;base::Transform&gt; <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo3">SLT</a>;     <span class="comment">///&lt; relative configuration of link's Solid from its origin</span>
<a name="l00128"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo4">00128</a> <span class="comment"></span>    <a class="code" href="classbase_1_1vector.html">base::Vector</a> q;                 <span class="comment">///&lt; joint variable parameter value at which A,T,ST were evaluated</span>
<a name="l00129"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo5">00129</a> <span class="comment"></span>    <a class="code" href="classbase_1_1Transform.html">base::Transform</a> <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo5">mountToBaseSolid</a>;  <span class="comment">///&lt; transform from mount frame to base Solid frame</span>
<a name="l00130"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo6">00130</a> <span class="comment"></span>    <a class="code" href="classbase_1_1Transform.html">base::Transform</a> <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfoo6">eeToEESolid</a>;       <span class="comment">///&lt; transform from ee frame to ee Solid frame</span>
00131 <span class="comment"></span>  };
00132   
00133 <span class="comment"></span>
00134 <span class="comment">  /// create the Solids for each link and assemble them into a Spatial tree (and add them to solidSystem)</span>
00135 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb3">createLinks</a>(<span class="keyword">const</span> array&lt;base::Dimension3&gt;&amp; linkDims) = 0;
00136                  <span class="comment"></span>
00137 <span class="comment">  /// position the links </span>
00138 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb4">positionLinks</a>(<span class="keyword">const</span> <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html">TransformInfo</a>&amp; transformInfo) = 0;
00139                      
00140   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb5">disableCollisions</a>(<span class="keyword">const</span> array&lt;<a class="code" href="classbase_1_1ref.html">ref&lt;physics::Collidable&gt;</a> &gt;&amp; collidables,
00141                                  <span class="keyword">const</span> array&lt;<a class="code" href="classbase_1_1ref.html">ref&lt;physics::Collidable&gt;</a> &gt;&amp; proximityCollidables) = 0;
00142                      
00143   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb6">attachJoints</a>(<span class="keyword">const</span> <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1TransformInfo.html">TransformInfo</a>&amp; transformInfo) = 0;
00144 
<a name="l00145"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp11">00145</a>   array&lt;ref&lt;physics::SpatialGroup&gt; &gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp11">linkGroups</a>;   <span class="comment">///&lt; a group for each link (which contains the link Solid and the group for the next link)</span>
00146 <span class="comment"></span>
<a name="l00147"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp12">00147</a>   array&lt;ref&lt;physics::Solid&gt; &gt; links;   <span class="comment">///&lt; Solids for each link</span>
<a name="l00148"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp13">00148</a> <span class="comment"></span>  array&lt;ref&lt;physics::Joint&gt; &gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp13">joints</a>;  <span class="comment">///&lt; Joint attaching each pair of consecutive links (dynamic simulation only)</span>
<a name="l00149"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp14">00149</a> <span class="comment"></span>  array&lt;Real&gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp14">linkLengths</a>;             <span class="comment">///&lt; Length of each link corresponding with links[]</span>
<a name="l00150"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp15">00150</a> <span class="comment"></span>  array&lt;ref&lt;physics::Collidable&gt; &gt; collidables;          <span class="comment">///&lt; collidables for each link Solid</span>
<a name="l00151"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp16">00151</a> <span class="comment"></span>  array&lt;ref&lt;physics::Collidable&gt; &gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp16">proximityCollidables</a>; <span class="comment">///&lt; collidables for each link's proximity sensor</span>
00152 <span class="comment"></span>
<a name="l00153"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp17">00153</a>   <span class="keyword">mutable</span> <a class="code" href="classbase_1_1vector.html">base::Vector</a> q; <span class="comment">///&lt; current joint parameters (static simulation only)</span>
00154 <span class="comment"></span>  
00155   
00156   <span class="comment">// this CollisionResponseHandler is inserted before the final handler to </span>
00157   <span class="comment">//  filter out collisions between the proximity sensor Collidables and</span>
00158   <span class="comment">//  handle them appropriately</span>
<a name="l00159"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html">00159</a>   <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html">ProximityCollisionResponseHandler</a> : <span class="keyword">public</span> <a class="code" href="physics_2Jamfile_8ft.html#a0">physics</a>::CollisionResponseHandler
00160   {
00161   <span class="keyword">public</span>:
00162     <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlera0">ProximityCollisionResponseHandler</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedKinematicChain&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlerp0">kc</a>, <a class="code" href="classbase_1_1ref.html">ref&lt;physics::CollisionDetector&gt;</a> collisionDetector);
00163 
<a name="l00164"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlera1">00164</a>     <span class="keyword">virtual</span> String <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlera1">className</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> String(<span class="stringliteral">"ProximityCollisionResponseHandler"</span>); }
00165     
00166     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlera2">reset</a>();
00167     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlera3">collide</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;const physics::Collidable&gt;</a> collidable1, <a class="code" href="classbase_1_1ref.html">ref&lt;const physics::Collidable&gt;</a> collidable2);
00168     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlera4">handleCollision</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;physics::CollisionState&gt;</a> collisionState); <span class="comment">///&lt; calls KinematicChain::handleCollision()</span>
00169 <span class="comment"></span>    
00170     <span class="keyword">protected</span>:
<a name="l00171"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlerp0">00171</a>       <a class="code" href="classbase_1_1ref.html">ref&lt;SimulatedKinematicChain&gt;</a> kc;
<a name="l00172"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlerp1">00172</a>       <span class="keywordtype">bool</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandlerp1">resetCalled</a>;
00173   };
00174 
00175   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainb7">handleCollision</a>(<a class="code" href="classbase_1_1ref.html">ref&lt;physics::CollisionState&gt;</a> collisionState) = 0;  <span class="comment">///&lt; called from ProximityCollisionResponseHandler::handleCollision()</span>
00176 <span class="comment"></span>  
<a name="l00177"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolx1">00177</a>   <span class="keyword">enum</span> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolx1">CollidableClasses</a> { <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolx1robot_1_1sim_1_1SimulatedToolx0">SensorCollidableClass</a> = 1 };
00178   
<a name="l00179"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp18">00179</a>   <a class="code" href="classbase_1_1ref.html">ref&lt;physics::CollidableGroup&gt;</a> <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp18">proximityCollidableGroup</a>;
00180   
<a name="l00181"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html">00181</a>   <span class="keyword">struct </span><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html">ProximityData</a> {
<a name="l00182"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDataa0">00182</a>     <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDataa0">ProximityData</a>() : dist(<a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html">SimulatedKinematicChain</a>::maxDist+1.0) {}
<a name="l00183"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDataa1">00183</a>     <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDataa0">ProximityData</a>(Real dist, Real intersect, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">Vector3</a>&amp; dir)
00184       : dist(dist), intersect(intersect), dir(dir) {}
00185     
<a name="l00186"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDatao0">00186</a>     Real    dist;      <span class="comment">///&lt; distance to object (&gt; maxInt =&gt; no object in proximity)</span>
<a name="l00187"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDatao1">00187</a> <span class="comment"></span>    Real    <a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDatao1">intersect</a>; <span class="comment">///&lt; distance along link x-axis of sensor</span>
<a name="l00188"></a><a class="code" href="structrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityData.html#robot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityDatao2">00188</a> <span class="comment"></span>    <a class="code" href="classbase_1_1Vector3.html">Vector3</a> dir;       <span class="comment">///&lt; direction of object from sensor</span>
00189 <span class="comment"></span>  };
00190   
<a name="l00191"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp19">00191</a>   array&lt; ProximityData &gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp19">linkProximity</a>; 
00192   <span class="comment">// !!! this assumes cylindrical/capsule surface</span>
<a name="l00193"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp20">00193</a>   array&lt; Real &gt; <a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedToolp20">linkProximitySurfPosition</a>;     <span class="comment">///&lt; dist from link axis of proximity sensor (i.e. on link sufrace)</span>
00194 <span class="comment"></span>  
<a name="l00195"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedKinematicChainn0">00195</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedRobot.html">SimulatedRobot</a>;
<a name="l00196"></a><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain.html#robot_1_1sim_1_1SimulatedTooln2">00196</a>   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classrobot_1_1sim_1_1SimulatedKinematicChain_1_1ProximityCollisionResponseHandler.html">ProximityCollisionResponseHandler</a>;
00197 };
00198 
00199 
00200 
00201 }
00202 } <span class="comment">// robot::sim</span>
00203 
00204 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Jul 29 15:56:40 2004 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
