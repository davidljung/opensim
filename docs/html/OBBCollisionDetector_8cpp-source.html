<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OpenSim: physics/OBBCollisionDetector.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>physics/OBBCollisionDetector.cpp</h1><a href="OBBCollisionDetector_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/****************************************************************************</span>
00002 <span class="comment">  Copyright (C)1996 David Jung &lt;opensim@pobox.com&gt;</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This program/file is free software; you can redistribute it and/or modify</span>
00005 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment">  (at your option) any later version.</span>
00008 <span class="comment">  </span>
00009 <span class="comment">  This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment">  GNU General Public License for more details. (http://www.gnu.org)</span>
00013 <span class="comment">  </span>
00014 <span class="comment">  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment">  along with this program; if not, write to the Free Software</span>
00016 <span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00017 <span class="comment">  </span>
00018 <span class="comment">  $Id: OBBCollisionDetector.cpp 1031 2004-02-11 20:46:36Z jungd $</span>
00019 <span class="comment">  $Revision: 1.3 $</span>
00020 <span class="comment">  $Date: 2004-02-11 15:46:36 -0500 (Wed, 11 Feb 2004) $</span>
00021 <span class="comment">  $Author: jungd $</span>
00022 <span class="comment"> </span>
00023 <span class="comment">****************************************************************************/</span>
00024 
00025 <span class="preprocessor">#include &lt;<a class="code" href="OBBCollisionDetector.html">physics/OBBCollisionDetector</a>&gt;</span>
00026 <span class="preprocessor">#include &lt;<a class="code" href="Quat4.html">base/Quat4</a>&gt;</span>
00027 
00028 <span class="keyword">using</span> <a class="code" href="classphysics_1_1OBBCollisionDetector.html">physics::OBBCollisionDetector</a>;
00029 <span class="keyword">using</span> <a class="code" href="classphysics_1_1CollisionState.html">physics::CollisionState</a>;
00030 <span class="keyword">using</span> <a class="code" href="classphysics_1_1CollisionModelProvider.html">physics::CollisionModelProvider</a>;
00031 <span class="keyword">using</span> <a class="code" href="classbase_1_1Vector3.html">base::Vector3</a>;
00032 <span class="keyword">using</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>;
00033 <span class="keyword">using</span> base::transpose;
00034 <span class="keyword">using</span> base::inverse;
00035 <span class="keyword">using</span> base::cross;
00036 <span class="keyword">using</span> <a class="code" href="classgfx_1_1Triangle3.html">gfx::Triangle3</a>;
00037 
00038 
00039 <span class="comment">// public</span>
00040 
00041 <span class="keywordtype">bool</span> OBBCollisionDetector::collision(ref&lt;const Solid&gt; solid1, ref&lt;const Solid&gt; solid2, CollisionQueryType queryType)
00042 {
00043   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp0">collisionDetectionEnabled</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00044   <span class="keywordflow">if</span> (queryType == PotentialCollision) <span class="keywordflow">return</span> <span class="keyword">true</span>;
00045 
00046   ref&lt;const OBBCollisionModel&gt; model1 
00047     = narrow_ref&lt;const OBBCollisionModel&gt;(solid1-&gt;getCollisionModel(<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectora2">getType</a>()));
00048   ref&lt;const OBBCollisionModel&gt; model2 
00049     = narrow_ref&lt;const OBBCollisionModel&gt;(solid2-&gt;getCollisionModel(<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectora2">getType</a>()));
00050 
00051   Matrix3 R1 = Matrix4(solid1-&gt;getOrientation()); <span class="comment">// a better way to convert? !!</span>
00052   Matrix3 R2 = Matrix4(solid2-&gt;getOrientation());
00053   <span class="keyword">const</span> Vector3&amp; T1(solid1-&gt;getPosition());
00054   <span class="keyword">const</span> Vector3&amp; T2(solid2-&gt;getPosition());
00055 
00056   <span class="comment">// Collision test</span>
00057   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb0">Collide</a>(R1, T1, model1, R2, T2, model2, queryType);
00058   <span class="comment">//std::cout &lt;&lt; "State - box:" &lt;&lt; numBoxTests</span>
00059   <span class="comment">//        &lt;&lt; " tri: " &lt;&lt; numTriTests</span>
00060   <span class="comment">//        &lt;&lt; " contacts:" &lt;&lt; contacts.size() </span>
00061   <span class="comment">//        &lt;&lt; " contact:" &lt;&lt; contacts[0].first &lt;&lt; "\n";</span>
00062 
00063   <span class="keywordtype">double</span> R1a[3][3];
00064   R1a[0][0] = R1(1,1); R1a[0][1] = R1(1,2); R1a[0][2] = R1(1,3);
00065   R1a[1][0] = R1(2,1); R1a[1][1] = R1(2,2); R1a[1][2] = R1(2,3);
00066   R1a[2][0] = R1(3,1); R1a[2][1] = R1(3,2); R1a[2][2] = R1(3,3);
00067   <span class="keywordtype">double</span> R2a[3][3];
00068   R2a[0][0] = R2(1,1); R2a[0][1] = R2(1,2); R2a[0][2] = R2(1,3);
00069   R2a[1][0] = R2(2,1); R2a[1][1] = R2(2,2); R2a[1][2] = R2(2,3);
00070   R2a[2][0] = R2(3,1); R2a[2][1] = R2(3,2); R2a[2][2] = R2(3,3);
00071 
00072   <span class="keywordtype">double</span> T1a[3]; T1a[0] = T1[1]; T1a[1] = T1[2]; T1a[2] = T1[3];
00073   <span class="keywordtype">double</span> T2a[3]; T2a[0] = T2[1]; T2a[1] = T2[2]; T2a[2] = T2[3];
00074   
00075   <span class="comment">// find the CollisionState</span>
00076   ref&lt;CollisionState&gt; collisionState = <a class="code" href="classphysics_1_1CollisionDetector.html#physics_1_1SOLIDCollisionDetectora9">getCollisionState</a>(solid1,solid2);
00077   ref&lt;OBBCollisionState&gt; state = narrow_ref&lt;OBBCollisionState&gt;(collisionState);
00078   state-&gt;contacts.clear();
00079   
00080   <span class="comment">// Compute collision points (if required)</span>
00081   <span class="keywordflow">if</span> ( ((queryType == <a class="code" href="classphysics_1_1CollisionDetector.html#physics_1_1SOLIDCollisionDetectorw3physics_1_1SOLIDCollisionDetectorw1">FirstContactPoint</a>) 
00082         || (queryType == <a class="code" href="classphysics_1_1CollisionDetector.html#physics_1_1SOLIDCollisionDetectorw3physics_1_1SOLIDCollisionDetectorw2">AllContactPoints</a>))
00083        &amp;&amp; <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp8">contacts</a>.size() &gt; 0) {
00084     
00085     <a class="code" href="namespacebase.html#a2">Int</a> i=0;
00086     <span class="keywordflow">do</span> {
00087       Triangle3 t1 = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp8">contacts</a>[i].first;
00088       Triangle3 t2 = contacts[i].second;
00089       
00090       <span class="comment">// !!! this is a hack for the contact normal - compute it properly!!</span>
00091       Vector3 normal1(t1.normal());
00092 
00093       <span class="comment">// Transform to world coords</span>
00094       t1.transform(R1); t1 += T1;
00095       t2.transform(R2); t2 += T2;
00096       
00097       <a class="code" href="namespacebase.html#a26">Point3</a> contactPoint; <span class="comment">//!!! fix = t1.intersect(t2);</span>
00098 <span class="comment"></span>      
00099       <span class="keywordflow">if</span> (contactPoint == <a class="code" href="namespacebase.html#a26">Point3</a>()) {
00100         <span class="comment">//Debugln("Failed to compute contact point!");</span>
00101         contactPoint = (t2[1]+t2[2]+t2[3])/3.0;
00102       }
00103       
00104       <a class="code" href="namespacebase.html#a26">Point3</a> contact1(contactPoint-T1);<span class="comment">//!!! untested</span>
00105 <span class="comment"></span>      contact1 = <a class="code" href="namespacebase.html#a115">inverse</a>(R1)*contact1;
00106       <a class="code" href="namespacebase.html#a26">Point3</a> contact2(contactPoint-T2);
00107       contact2 = <a class="code" href="namespacebase.html#a115">inverse</a>(R2)*contact2;
00108 
00109       <span class="comment">//      Point3 contact1(gfx::inverse(transform1.getTransform())*contactPoint);</span>
00110       <span class="comment">//      Point3 contact2(gfx::inverse(transform2.getTransform())*contactPoint);</span>
00111       
00112       <span class="comment">//                        Debugln("Contacts:" &lt;&lt; i &lt;&lt; ": " &lt;&lt; contact1 &lt;&lt; " and " &lt;&lt; contact2 </span>
00113       <span class="comment">//                                                        &lt;&lt; " global:" &lt;&lt; contactPoint);</span>
00114 
00115       state-&gt;contacts.push_back(CollisionState::Contact(contact1,contact2,normal1));
00116       
00117       i++;
00118     } <span class="keywordflow">while</span> ((i &lt; contacts.size()) &amp;&amp; (queryType == <a class="code" href="classphysics_1_1CollisionDetector.html#physics_1_1SOLIDCollisionDetectorw3physics_1_1SOLIDCollisionDetectorw2">AllContactPoints</a>));
00119     
00120   }
00121     
00122   <span class="keywordflow">return</span> (<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp8">contacts</a>.size() &gt; 0);
00123 }
00124 
00125 
00126 
00127 
00128 
00129 
00130 
00131 <span class="comment">// protected</span>
00132 
00133 <span class="keywordtype">void</span> OBBCollisionDetector::Collide(<span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>&amp; R1, <span class="keyword">const</span> gfx::Vector3&amp; T1, 
00134                                    ref&lt;const OBBCollisionModel&gt; model1,
00135                                    <span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>&amp; R2, <span class="keyword">const</span> gfx::Vector3&amp; T2, 
00136                                    ref&lt;const OBBCollisionModel&gt; model2,
00137                                    CollisionQueryType queryType)
00138 {
00139   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb0">Collide</a>(R1,T1,1.0,model1,R2,T2,1.0,model2,queryType);
00140 }
00141 
00142 
00143 <span class="keywordtype">void</span> OBBCollisionDetector::Collide(<span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>&amp; R1, <span class="keyword">const</span> gfx::Vector3&amp; T1, Real s1, 
00144                                    ref&lt;const OBBCollisionModel&gt; model1,
00145                                    <span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>&amp; R2, <span class="keyword">const</span> gfx::Vector3&amp; T2, Real s2, 
00146                                    ref&lt;const OBBCollisionModel&gt; model2,
00147                                    CollisionQueryType queryType)
00148 {
00149   <span class="comment">// reset the report fields</span>
00150   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectoro0">numBoxTests</a> = 0;
00151   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectoro1">numTriTests</a> = 0;
00152   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp8">contacts</a>.clear();
00153 
00154   <span class="keywordflow">if</span> (model1-&gt;tris.empty() || model2-&gt;tris.empty()) <span class="keywordflow">return</span>; <span class="comment">// no triangles in one of the models</span>
00155 
00156   <span class="keyword">const</span> OBBCollisionModel::OBB&amp; b1(model1-&gt;b[0]);
00157   <span class="keyword">const</span> OBBCollisionModel::OBB&amp; b2(model2-&gt;b[0]);
00158   
00159   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp9">firstContact</a> = (queryType==<a class="code" href="classphysics_1_1CollisionDetector.html#physics_1_1SOLIDCollisionDetectorw3physics_1_1SOLIDCollisionDetectorw0">DetectCollision</a>) || (queryType==<a class="code" href="classphysics_1_1CollisionDetector.html#physics_1_1SOLIDCollisionDetectorw3physics_1_1SOLIDCollisionDetectorw1">FirstContactPoint</a>);
00160   
00161   Matrix3 tR1, tR2, <a class="code" href="Globals_8h.html#a15">R</a>;
00162   Vector3 tT1, tT2, T, U;
00163   <a class="code" href="namespacebase.html#a5">Real</a> s;
00164         
00165   <span class="comment">// [R1,T1,s1] and [R2,T2,s2] are how the two triangle sets</span>
00166   <span class="comment">// (i.e. models) are positioned in world space.  [tR1,tT1,s1] and</span>
00167   <span class="comment">// [tR2,tT2,s2] are how the top level boxes are positioned in world</span>
00168   <span class="comment">// space</span>
00169   
00170   tR1 = R1*b1.pR;
00171   tT1 = (s1*R1)*b1.pT+T1;
00172   tR2 = R2*b2.pR;
00173   tT2 = (s2*R2)*b2.pT+T2;
00174   
00175   <span class="comment">// (R,T,s) is the placement of b2's top level box within</span>
00176   <span class="comment">// the coordinate system of b1's top level box.</span>
00177   
00178   <a class="code" href="Globals_8h.html#a15">R</a> = <a class="code" href="namespacebase.html#a98">transpose</a>(tR1)*tR2;       
00179   U = tT2-tT1;
00180   T = (<a class="code" href="namespacebase.html#a98">transpose</a>(tR1)*U)/s1;
00181   
00182   s = s2/s1;
00183   
00184   <span class="comment">// To transform tri's from model1's CS to model2's CS use this:</span>
00185   <span class="comment">//    x2 = ms . mR . x1 + mT</span>
00186   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp5">mR</a> = <a class="code" href="namespacebase.html#a98">transpose</a>(R2)*R1;
00187   U = T1-T2;
00188   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp6">mT</a> = (<a class="code" href="namespacebase.html#a98">transpose</a>(R2)*U)/s2;
00189   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp7">ms</a> = s1/s2;
00190   
00191   <span class="comment">// make the call</span>
00192   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb2">collideRecursive</a>(b1, b2, R, T, s);
00193 
00194 }
00195 
00196 
00197 <span class="keywordtype">void</span> OBBCollisionDetector::collideRecursive(<span class="keyword">const</span> OBBCollisionModel::OBB&amp; b1, 
00198                                             <span class="keyword">const</span> OBBCollisionModel::OBB&amp; b2,
00199                                             <span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>&amp; R, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Vector3</a>&amp; T, <span class="keywordtype">double</span> s)
00200 {
00201   <span class="keywordflow">if</span> ((<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp9">firstContact</a>) &amp;&amp; (<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp8">contacts</a>.size() &gt; 0)) <span class="keywordflow">return</span>;
00202   
00203   <span class="comment">// test top level</span>
00204   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectoro0">numBoxTests</a>++;
00205   
00206   Vector3 d(s*b2.d);
00207   <a class="code" href="namespacebase.html#a2">Int</a> <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp19">f1</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb6">OBBDisjoint</a>(R, T, b1.d, d);
00208   
00209   <span class="keywordflow">if</span> (f1 != 0) 
00210     <span class="keywordflow">return</span>;  <span class="comment">// stop processing this test, go to top of loop</span>
00211   
00212   <span class="comment">// contact between boxes</span>
00213   <span class="keywordflow">if</span> (b1.leaf() &amp;&amp; b2.leaf()) {
00214     <span class="comment">// it is a leaf pair - compare the polygons therein</span>
00215     <span class="comment">// tri_contact uses the model-to-model transforms stored in</span>
00216     <span class="comment">// mR, mT, ms.</span>
00217     
00218     <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb3">triContact</a>(b1, b2);
00219     <span class="keywordflow">return</span>;
00220   }
00221   
00222   Vector3 U;
00223   Matrix3 cR;
00224   Vector3 cT;
00225   <a class="code" href="namespacebase.html#a5">Real</a> cs;
00226   
00227   <span class="comment">// Currently, the transform from model 2 to model 1 space is</span>
00228   <span class="comment">// given by [B T s], where y = [B T s].x = s.B.x + T.</span>
00229   
00230   <span class="keywordflow">if</span> (b2.leaf() || (!b1.leaf() &amp;&amp; (b1.size() &gt; b2.size()))) {
00231     <span class="comment">// here we descend to children of b1.  The transform from</span>
00232     <span class="comment">// a child of b1 to b1 is stored in [b1.N.pR,b1.N.pT],</span>
00233     <span class="comment">// but we will denote it [B1 T1 1] for short.  Notice that</span>
00234     <span class="comment">// children boxes always have same scaling as parent, so s=1</span>
00235     <span class="comment">// for such nested transforms.</span>
00236     
00237     <span class="comment">// Here, we compute [B1 T1 1]'[B T s] = [B1'B B1'(T-T1) s]</span>
00238     <span class="comment">// for each child, and store the transform into the collision</span>
00239     <span class="comment">// test queue.</span>
00240     
00241     cR = <a class="code" href="namespacebase.html#a98">transpose</a>(b1.N-&gt;pR)*<a class="code" href="Globals_8h.html#a15">R</a>;
00242     U=T-b1.N-&gt;pT;
00243     cT = <a class="code" href="namespacebase.html#a98">transpose</a>(b1.N-&gt;pR)*U;
00244     cs = s;
00245     
00246     <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb2">collideRecursive</a>(*b1.N, b2, cR, cT, cs);
00247     
00248     cR = <a class="code" href="namespacebase.html#a98">transpose</a>(b1.P-&gt;pR)*<a class="code" href="Globals_8h.html#a15">R</a>;
00249     U=T-b1.P-&gt;pT;
00250     cT=<a class="code" href="namespacebase.html#a98">transpose</a>(b1.P-&gt;pR)*U;
00251     cs = s;
00252     
00253     <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb2">collideRecursive</a>(*b1.P, b2, cR, cT, cs);
00254     
00255     <span class="keywordflow">return</span>;
00256   }
00257   <span class="keywordflow">else</span> {
00258     <span class="comment">// here we descend to the children of b2.  See comments for</span>
00259     <span class="comment">// other 'if' clause for explanation.</span>
00260     
00261     cR = <a class="code" href="Globals_8h.html#a15">R</a>*b2.N-&gt;pR;
00262     cT = (s*<a class="code" href="Globals_8h.html#a15">R</a>)*b2.N-&gt;pT+T;
00263     cs = s;
00264     
00265     <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb2">collideRecursive</a>(b1, *b2.N, cR, cT, cs);
00266     
00267     cR = <a class="code" href="Globals_8h.html#a15">R</a>*b2.P-&gt;pR;
00268     cT = (s*<a class="code" href="Globals_8h.html#a15">R</a>)*b2.P-&gt;pT+T;
00269     cs = s;
00270     
00271     <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb2">collideRecursive</a>(b1, *b2.P, cR, cT, cs);
00272     
00273     <span class="keywordflow">return</span>; 
00274   }
00275 }
00276 
00277 
00278 <span class="keywordtype">void</span> OBBCollisionDetector::triContact(<span class="keyword">const</span> OBBCollisionModel::OBB&amp; b1,
00279                                       <span class="keyword">const</span> OBBCollisionModel::OBB&amp; b2)
00280 {
00281   <span class="comment">// assume just one triangle in each box.</span>
00282   
00283   <span class="comment">// the vertices of the tri in b2 is in model1 C.S.  The vertices of</span>
00284   <span class="comment">// the other triangle is in model2 CS.  Use mR, mT, and</span>
00285   <span class="comment">// ms to transform into model2 CS.</span>
00286   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp10">p1</a> = b1.tr.p1();
00287   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp11">p2</a> = b1.tr.p2();
00288   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp12">p3</a> = b1.tr.p3();
00289   
00290   Matrix3 msR(ms*mR);
00291   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp1">i1</a> = msR*<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp10">p1</a>+<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp6">mT</a>;
00292   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp2">i2</a> = msR*<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp11">p2</a>+<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp6">mT</a>;
00293   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp3">i3</a> = msR*<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp12">p3</a>+<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp6">mT</a>;
00294   
00295   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectoro1">numTriTests</a>++;
00296   
00297   <span class="keywordflow">if</span> (<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb3">triContact</a>(i1, i2, i3, b2.tr.p1(), b2.tr.p2(), b2.tr.p3()))
00298     <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp8">contacts</a>.push_back(std::pair&lt;Triangle3,Triangle3&gt;(b1.tr, b2.tr));
00299 }
00300 
00301 
00302 <span class="keywordtype">bool</span> OBBCollisionDetector::triContact(<span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Vector3</a>&amp; P1, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Vector3</a>&amp; P2, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Vector3</a>&amp; P3,
00303                                       <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; Q1, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; Q2, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Point3</a>&amp; Q3)
00304 {
00305   <span class="comment">/*</span>
00306 <span class="comment">    One triangle is (p1,p2,p3).  Other is (q1,q2,q3).</span>
00307 <span class="comment">    Edges are (e1,e2,e3) and (f1,f2,f3).</span>
00308 <span class="comment">    Normals are n1 and m1</span>
00309 <span class="comment">    Outwards are (g1,g2,g3) and (h1,h2,h3).</span>
00310 <span class="comment">    </span>
00311 <span class="comment">    We assume that the triangle vertices are in the same coordinate system.</span>
00312 <span class="comment">    </span>
00313 <span class="comment">    First thing we do is establish a new c.s. so that p1 is at (0,0,0).</span>
00314 <span class="comment">    </span>
00315 <span class="comment">  */</span>
00316   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp30">z</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a5">setZero</a>();
00317   
00318   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp10">p1</a> = <a class="code" href="Globals_8h.html#a25">P1</a>-<a class="code" href="Globals_8h.html#a25">P1</a>;
00319   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp11">p2</a> = <a class="code" href="Globals_8h.html#a26">P2</a>-<a class="code" href="Globals_8h.html#a25">P1</a>;
00320   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp12">p3</a> = <a class="code" href="Globals_8h.html#a27">P3</a>-<a class="code" href="Globals_8h.html#a25">P1</a>;
00321   
00322   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp13">q1</a> = Q1-<a class="code" href="Globals_8h.html#a25">P1</a>;
00323   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp14">q2</a> = Q2-<a class="code" href="Globals_8h.html#a25">P1</a>;
00324   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp15">q3</a> = Q3-<a class="code" href="Globals_8h.html#a25">P1</a>;
00325   
00326   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp16">e1</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp11">p2</a>-<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp10">p1</a>;
00327   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp17">e2</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp12">p3</a>-<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp11">p2</a>;
00328   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp18">e3</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp10">p1</a>-<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp12">p3</a>;
00329   
00330   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp19">f1</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp14">q2</a>-<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp13">q1</a>;
00331   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp20">f2</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp15">q3</a>-<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp14">q2</a>;
00332   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp21">f3</a> = <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp13">q1</a>-<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp15">q3</a>;
00333   
00334   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp28">n1</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e1, e2);
00335   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp29">m1</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(f1, f2);
00336   
00337   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp22">g1</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e1, n1);
00338   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp23">g2</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e2, n1);
00339   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp24">g3</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e3, n1);
00340   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp25">h1</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(f1, m1);
00341   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp26">h2</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(f2, m1);
00342   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp27">h3</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(f3, m1);
00343   
00344   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp31">ef11</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e1, f1);
00345   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp32">ef12</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e1, f2);
00346   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp33">ef13</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e1, f3);
00347   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp34">ef21</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e2, f1);
00348   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp35">ef22</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e2, f2);
00349   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp36">ef23</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e2, f3);
00350   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp37">ef31</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e3, f1);
00351   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp38">ef32</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e3, f2);
00352   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp39">ef33</a>.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3a24">cross</a>(e3, f3);
00353   
00354   <span class="comment">// now begin the series of tests</span>
00355   
00356   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(n1, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00357   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(m1, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00358   
00359   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef11, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00360   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef12, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00361   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef13, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00362   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef21, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00363   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef22, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00364   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef23, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00365   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef31, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00366   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef32, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00367   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(ef33, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00368   
00369   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(g1, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00370   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(g2, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00371   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(g3, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00372   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(h1, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00373   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(h2, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00374   <span class="keywordflow">if</span> (!<a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorb5">project6</a>(h3, p1, p2, p3, q1, q2, q3)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00375   
00376   <span class="keywordflow">return</span> <span class="keyword">true</span>;
00377 }
00378 
00379 
00380 <span class="keywordtype">bool</span> OBBCollisionDetector::project6(<span class="keyword">const</span> Vector3&amp; ax, 
00381                                     <span class="keyword">const</span> Vector3&amp; p1, <span class="keyword">const</span> Vector3&amp; p2, <span class="keyword">const</span> Vector3&amp; p3,
00382                                     <span class="keyword">const</span> Vector3&amp; q1, <span class="keyword">const</span> Vector3&amp; q2, <span class="keyword">const</span> Vector3&amp; q3)<span class="keyword"> const</span>
00383 <span class="keyword"></span>{
00384   <a class="code" href="namespacebase.html#a5">Real</a> <a class="code" href="Globals_8h.html#a25">P1</a> = ax.dot(p1);
00385   <a class="code" href="namespacebase.html#a5">Real</a> <a class="code" href="Globals_8h.html#a26">P2</a> = ax.dot(p2);
00386   <a class="code" href="namespacebase.html#a5">Real</a> <a class="code" href="Globals_8h.html#a27">P3</a> = ax.dot(p3);
00387   <a class="code" href="namespacebase.html#a5">Real</a> Q1 = ax.dot(q1);
00388   <a class="code" href="namespacebase.html#a5">Real</a> Q2 = ax.dot(q2);
00389   <a class="code" href="namespacebase.html#a5">Real</a> Q3 = ax.dot(q3);
00390   
00391   <a class="code" href="namespacebase.html#a5">Real</a> mx1 = Math::maximum(P1, P2, P3);
00392   <a class="code" href="namespacebase.html#a5">Real</a> mn1 = Math::minimum(P1, P2, P3);
00393   <a class="code" href="namespacebase.html#a5">Real</a> mx2 = Math::maximum(Q1, Q2, Q3);
00394   <a class="code" href="namespacebase.html#a5">Real</a> mn2 = Math::minimum(Q1, Q2, Q3);
00395   
00396   <span class="keywordflow">if</span> (mn1 &gt; mx2) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00397   <span class="keywordflow">if</span> (mn2 &gt; mx1) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00398   <span class="keywordflow">return</span> <span class="keyword">true</span>;
00399 }
00400 
00401 
00402 <a class="code" href="namespacebase.html#a2">Int</a> OBBCollisionDetector::OBBDisjoint(<span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>&amp; B, <span class="keyword">const</span> gfx::Vector3&amp; T,
00403                                       <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector3.html">base::Vector3</a>&amp; a, <span class="keyword">const</span> gfx::Vector3&amp; b)
00404 {
00405   <a class="code" href="namespacebase.html#a5">Real</a> t, s;
00406   
00407   <span class="comment">// Bf = fabs(B)</span>
00408   <span class="keyword">const</span> <a class="code" href="namespacebase.html#a5">Real</a> reps = CollisionDetector::collisionEpsilon;
00409   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) += reps;
00410   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) += reps;
00411   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) += reps;
00412   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) += reps;
00413   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) += reps;
00414   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) += reps;
00415   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1) += reps;
00416   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) += reps;
00417   <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) = <a class="code" href="namespacebase.html#a62">base::abs</a>(B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3));  <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) += reps;
00418   
00419   <span class="comment">// if any of these tests are one-sided, then the polyhedra are disjoint</span>
00420   
00421   <span class="comment">// A1 x A2 = A0</span>
00422   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(T.x);
00423   
00424   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3)))) <span class="keywordflow">return</span> 1;
00425   
00426   <span class="comment">// B1 x B2 = B0</span>
00427   s = T.x*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) + T.y*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) + T.z*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1);
00428   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00429   
00430   <span class="keywordflow">if</span> (!(t &lt;= (b.x + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1)))) <span class="keywordflow">return</span> 2;
00431   
00432   <span class="comment">// A2 x A0 = A1</span>
00433   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(T.y);
00434   
00435   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3)))) <span class="keywordflow">return</span> 3;
00436   
00437   <span class="comment">// A0 x A1 = A2</span>
00438   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(T.z);
00439   
00440   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3)))) <span class="keywordflow">return</span> 4;
00441   
00442   <span class="comment">// B2 x B0 = B1</span>
00443   s = T.x*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) + T.y*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) + T.z*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2);
00444   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00445   
00446   <span class="keywordflow">if</span> (!(t &lt;=(b.y + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2)))) <span class="keywordflow">return</span> 5;
00447   
00448   <span class="comment">// B0 x B1 = B2</span>
00449   s = T.x*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) + T.y*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) + T.z*B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3);
00450   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00451   
00452   <span class="keywordflow">if</span> (!(t &lt;= (b.z + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3)))) <span class="keywordflow">return</span> 6;
00453   
00454   <span class="comment">// A0 x B0</span>
00455   s = T.z * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) - T.y * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1);
00456   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00457   
00458   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2)))) <span class="keywordflow">return</span> 7;
00459   
00460   <span class="comment">// A0 x B1</span>
00461   s = T.z * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) - T.y * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2);
00462   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00463   
00464   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1)))) <span class="keywordflow">return</span> 8;
00465   
00466   <span class="comment">// A0 x B2</span>
00467   s = T.z * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) - T.y * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3);
00468   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00469   
00470   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1)))) <span class="keywordflow">return</span> 9;
00471   
00472   <span class="comment">// A1 x B0</span>
00473   s = T.x * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1) - T.z * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1);
00474   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00475   
00476   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2)))) <span class="keywordflow">return</span> 10;
00477   
00478   <span class="comment">// A1 x B1</span>
00479   s = T.x * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) - T.z * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2);
00480   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00481   
00482   <span class="keywordflow">if</span> (!(t &lt;=(a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1)))) <span class="keywordflow">return</span> 11;
00483   
00484   <span class="comment">// A1 x B2</span>
00485   s = T.x * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) - T.z * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3);
00486   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00487   
00488   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o2">z</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1)))) <span class="keywordflow">return</span> 12;
00489   
00490   <span class="comment">// A2 x B0</span>
00491   s = T.y * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) - T.x * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1);
00492   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00493   
00494   <span class="keywordflow">if</span> (!(t &lt;= (a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,1) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,1) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2)))) <span class="keywordflow">return</span> 13;
00495   
00496   <span class="comment">// A2 x B1</span>
00497   s = T.y * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) - T.x * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2);
00498   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00499   
00500   <span class="keywordflow">if</span> (!(t &lt;=(a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,2) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,2) + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,3) + b.z * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1)))) <span class="keywordflow">return</span> 14;
00501   
00502   <span class="comment">// A2 x B2</span>
00503   s = T.y * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) - T.x * B.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3);
00504   t = <a class="code" href="namespacebase.html#a62">base::abs</a>(s);
00505   
00506   <span class="keywordflow">if</span> (!(t &lt;=(a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o0">x</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(2,3) + a.<a class="code" href="classbase_1_1Vector3.html#base_1_1Vector3o1">y</a> * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(1,3) + b.x * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,2) + b.y * <a class="code" href="classphysics_1_1OBBCollisionDetector.html#physics_1_1OBBCollisionDetectorp4">Bf</a>.<a class="code" href="classbase_1_1Matrix3.html#base_1_1Matrix3a7">e</a>(3,1)))) <span class="keywordflow">return</span> 15;
00507   
00508   <span class="keywordflow">return</span> 0; 
00509   
00510 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Jul 29 15:56:24 2004 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
