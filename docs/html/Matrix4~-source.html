<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>opensim/base/Matrix4~ Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>opensim/base/Matrix4~</h1><a href="Matrix4~.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/****************************************************************************</font>
00002 <font class="comment">  Copyright (C)1996 David Jung &lt;djung@pobox.com&gt;</font>
00003 <font class="comment"></font>
00004 <font class="comment">  This program/file is free software; you can redistribute it and/or modify</font>
00005 <font class="comment">  it under the terms of the GNU General Public License as published by</font>
00006 <font class="comment">  the Free Software Foundation; either version 2 of the License, or</font>
00007 <font class="comment">  (at your option) any later version.</font>
00008 <font class="comment">  </font>
00009 <font class="comment">  This program is distributed in the hope that it will be useful,</font>
00010 <font class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</font>
00011 <font class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</font>
00012 <font class="comment">  GNU General Public License for more details. (http://www.gnu.org)</font>
00013 <font class="comment">  </font>
00014 <font class="comment">  You should have received a copy of the GNU General Public License</font>
00015 <font class="comment">  along with this program; if not, write to the Free Software</font>
00016 <font class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</font>
00017 <font class="comment">  </font>
00018 <font class="comment">  $Id: Matrix4,v 1.2 2002/06/25 18:33:09 jungd Exp $</font>
00019 <font class="comment">  $Revision: 1.2 $</font>
00020 <font class="comment">  $Date: 2002/06/25 18:33:09 $</font>
00021 <font class="comment">  $Author: jungd $</font>
00022 <font class="comment"> </font>
00023 <font class="comment">****************************************************************************/</font>
00024 
00025 <font class="preprocessor">#ifndef _BASE_MATRIX4_</font>
00026 <font class="preprocessor"></font><font class="preprocessor">#define _BASE_MATRIX4_</font>
00027 <font class="preprocessor"></font>
00028 <font class="preprocessor">#include &lt;iostream&gt;</font>
00029 
00030 <font class="preprocessor">#include &lt;<a class="code" href="base.html">base/base</a>&gt;</font>
00031 <font class="preprocessor">#include &lt;<a class="code" href="Object.html">base/Object</a>&gt;</font>
00032 <font class="preprocessor">#include &lt;<a class="code" href="Vector3.html">base/Vector3</a>&gt;</font>
00033 <font class="preprocessor">#include &lt;<a class="code" href="Vector4.html">base/Vector4</a>&gt;</font>
00034 <font class="preprocessor">#include &lt;<a class="code" href="Matrix3.html">base/Matrix3</a>&gt;</font>
00035 
00036 <font class="preprocessor">#ifdef USE_OSG</font>
00037 <font class="preprocessor"></font><font class="preprocessor">#include &lt;<a class="code" href="Matrix.html">osg/Matrix</a>&gt;</font>
00038 <font class="preprocessor">#endif</font>
00039 <font class="preprocessor"></font>
00040 
<a name="l00041"></a><a class="code" href="Matrix4~.html#a0">00041</a> <font class="preprocessor">#define MATRIX4_ACCESS(r,c) (4*(c-1)+r-1)</font>
00042 <font class="preprocessor"></font>
00043 
00044 <font class="keyword">namespace </font>base {
00045 
00046 <font class="keyword">class </font>Matrix4;
00047 
00048 <font class="comment">// classes to help speed up common vector/matrix operations</font>
00049 <font class="comment">//  (not used directly by the user)</font>
00050 
00051 <font class="keyword">struct </font>M4V4mul {
<a name="l00052"></a><a class="code" href="structbase_1_1M4V4mul.html#m0">00052</a>   <font class="keyword">const</font> Matrix4&amp; m;
<a name="l00053"></a><a class="code" href="structbase_1_1M4V4mul.html#m1">00053</a>   <font class="keyword">const</font> Vector4&amp; v;
00054 
<a name="l00055"></a><a class="code" href="structbase_1_1M4V4mul.html#a2">00055</a>   <a class="code" href="structbase_1_1M4V4mul.html#a0">M4V4mul</a>(<font class="keyword">const</font> Matrix4&amp; mm, <font class="keyword">const</font> Vector4&amp; vv) : m(mm), v(vv) {}
00056 
00057   <a class="code" href="structbase_1_1M4V4mul.html#a1">operator Vector4</a>() <font class="keyword">const</font>;
00058 };
00059 
00060 <font class="keyword">struct </font>M4V4mulV4add {
<a name="l00061"></a><a class="code" href="structbase_1_1M4V4mulV4add.html#m0">00061</a>   <font class="keyword">const</font> Matrix4&amp; m;
<a name="l00062"></a><a class="code" href="structbase_1_1M4V4mulV4add.html#m1">00062</a>   <font class="keyword">const</font> Vector4&amp; v;
<a name="l00063"></a><a class="code" href="structbase_1_1M4V4mulV4add.html#m2">00063</a>   <font class="keyword">const</font> Vector4&amp; v2;
00064 
<a name="l00065"></a><a class="code" href="structbase_1_1M4V4mulV4add.html#a2">00065</a>   <a class="code" href="structbase_1_1M4V4mulV4add.html#a0">M4V4mulV4add</a>(<font class="keyword">const</font> M4V4mul&amp; mv, <font class="keyword">const</font> Vector4&amp; vv) : m(mv.m), v(mv.v), v2(vv) {}
00066 
00067   <a class="code" href="structbase_1_1M4V4mulV4add.html#a1">operator Vector4</a>() <font class="keyword">const</font>;
00068 };
00069 
00070 
00071 <font class="comment">//</font>
00072 <font class="comment">// The matrix</font>
00073 <font class="comment">//</font>
00074 
00075 <font class="keyword">class </font>Matrix4 : <font class="keyword">public</font> base::Object
00076 {
00077 
00078 <font class="keyword">public</font>:
<a name="l00079"></a><a class="code" href="classbase_1_1Matrix4.html#a46">00079</a>   <a class="code" href="classbase_1_1Matrix4.html#a0">Matrix4</a>()<font class="keyword"> </font>{ <a class="code" href="classbase_1_1Matrix4.html#a8">setIdentity</a>(); }
<a name="l00080"></a><a class="code" href="classbase_1_1Matrix4.html#a47">00080</a>   <a class="code" href="classbase_1_1Matrix4.html#a0">Matrix4</a>(<font class="keyword">const</font> Matrix4&amp; m)<font class="keyword"> </font>{ this-&gt;<a class="code" href="classbase_1_1Matrix4.html#a26">operator=</a>(m); }
<a name="l00081"></a><a class="code" href="classbase_1_1Matrix4.html#a48">00081</a>   <a class="code" href="classbase_1_1Matrix4.html#a0">Matrix4</a>(<font class="keyword">const</font> Matrix3&amp; m)<font class="keyword"> </font>
00082 <font class="keyword">  </font>{
00083     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,1)=m.e(1,1); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,2)=m.e(1,2); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,3)=m.e(1,3); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,4)=0;
00084     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,1)=m.e(2,1); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,2)=m.e(2,2); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,3)=m.e(2,3); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,4)=0;
00085     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,1)=m.e(3,1); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,2)=m.e(3,2); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,3)=m.e(3,3); <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,4)=0;
00086     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,1) = <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,2) = <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,3) = 0; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,4) = 1;
00087   } 
<a name="l00088"></a><a class="code" href="classbase_1_1Matrix4.html#a49">00088</a>   <font class="keyword">explicit</font> <a class="code" href="classbase_1_1Matrix4.html#a0">Matrix4</a>(<font class="keyword">const</font> Real&amp; s)<font class="keyword"> </font>{ setDiag(s); }
<a name="l00089"></a><a class="code" href="classbase_1_1Matrix4.html#a50">00089</a>   <a class="code" href="classbase_1_1Matrix4.html#a0">Matrix4</a>(Real e11, Real e12, Real e13, Real e14,
00090           Real e21, Real e22, Real e23, Real e24,
00091           Real e31, Real e32, Real e33, Real e34,
00092           Real e41, Real e42, Real e43, Real e44)<font class="keyword"></font>
00093 <font class="keyword">  </font>{
00094     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,1)=e11; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,2)=e12; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,3)=e13; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,4)=e14;
00095     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,1)=e21; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,2)=e22; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,3)=e23; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,4)=e24;
00096     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,1)=e31; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,2)=e32; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,3)=e33; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,4)=e34;
00097     <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,1)=e41; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,2)=e42; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,3)=e43; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,4)=e44;
00098   }
00099 
00100 <font class="preprocessor">#ifdef USE_OSG</font>
<a name="l00101"></a><a class="code" href="classbase_1_1Matrix4.html#a51">00101</a> <font class="preprocessor"></font>  <a class="code" href="classbase_1_1Matrix4.html#a0">Matrix4</a>(<font class="keyword">const</font> osg::Matrix&amp; matrix)<font class="keyword"></font>
00102 <font class="keyword">  </font>{
00103     <font class="comment">// NB: This relies on both types having the same layout</font>
00104     <font class="comment">//  (except that Real doesn't have to be a float)</font>
00105     <font class="keyword">const</font> <font class="keywordtype">float</font>* mat = matrix.ptr();
00106     <font class="keywordflow">for</font>(Int e=0; e&lt;16; e++)
00107       m[e] = mat[e];
00108   }
00109 <font class="preprocessor">#endif</font>
<a name="l00110"></a><a class="code" href="classbase_1_1Matrix4.html#a52">00110</a> <font class="preprocessor"></font>  <a class="code" href="classbase_1_1Matrix4.html#a6">~Matrix4</a>()<font class="keyword"> </font>{}
00111 
<a name="l00112"></a><a class="code" href="classbase_1_1Matrix4.html#a53">00112</a>   <font class="keyword">virtual</font> String <a class="code" href="classbase_1_1Matrix4.html#a7">className</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="namespace__base.html#a4">String</a>(<font class="stringliteral">"Matrix4"</font>); }
00113 
<a name="l00114"></a><a class="code" href="classbase_1_1Matrix4.html#a54">00114</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a8">setIdentity</a>() <font class="keywordflow">throw</font>()
00115   {
00116     setDiag(<a class="code" href="namespace__base.html#a5">Real</a>(1));
00117   }
00118 
<a name="l00119"></a><a class="code" href="classbase_1_1Matrix4.html#a55">00119</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a9">setZero</a>() <font class="keywordflow">throw</font>()
00120   {
00121     setDiag(<a class="code" href="namespace__base.html#a5">Real</a>(0));
00122   }
00123 
00124 
<a name="l00125"></a><a class="code" href="classbase_1_1Matrix4.html#a56">00125</a>   Real&amp; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(Int row, Int col) <font class="keywordflow">throw</font>()
00126   {
00127 <font class="preprocessor">#ifdef DEBUG</font>
00128 <font class="preprocessor"></font>    <font class="keywordflow">if</font> ((row &lt; 1) || (row &gt; 4) || (col &lt; 1) || (col &gt; 4))
00129       <font class="keywordflow">throw</font> std::runtime_error(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"matrix row or col out of bounds (debug only check)"</font>));
00130 <font class="preprocessor">#endif </font>
00131 <font class="preprocessor"></font>    <font class="keywordflow">return</font> m[<a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(row,col)]; 
00132   }
00133 
<a name="l00134"></a><a class="code" href="classbase_1_1Matrix4.html#a57">00134</a>   <font class="keyword">const</font> Real&amp; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(Int row, Int col) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00135   {
00136 <font class="preprocessor">#ifdef DEBUG</font>
00137 <font class="preprocessor"></font>    <font class="keywordflow">if</font> ((row &lt; 1) || (row &gt; 4) || (col &lt; 1) || (col &gt; 4))
00138       <font class="keywordflow">throw</font> std::runtime_error(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"matrix row or col out of bounds (debug only check)"</font>));
00139 <font class="preprocessor">#endif </font>
00140 <font class="preprocessor"></font>    <font class="keywordflow">return</font> m[<a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(row,col)]; 
00141   }
00142 
<a name="l00143"></a><a class="code" href="classbase_1_1Matrix4.html#a58">00143</a>   Real&amp; <a class="code" href="classbase_1_1Matrix4.html#a12">at</a>(Int row, Int col) <font class="keywordflow">throw</font>(std::out_of_range)
00144   {
00145     <font class="keywordflow">if</font> ((row &lt; 1) || (row &gt; 4) || (col &lt; 1) || (col &gt; 4))
00146       <font class="keywordflow">throw</font> std::out_of_range(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"matrix row or col out of bounds"</font>));
00147 
00148     <font class="keywordflow">return</font> m[<a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(row,col)];
00149   }
00150 
<a name="l00151"></a><a class="code" href="classbase_1_1Matrix4.html#a59">00151</a>   <font class="keyword">const</font> Real&amp; <a class="code" href="classbase_1_1Matrix4.html#a12">at</a>(Int row, Int col) <font class="keyword">const</font> <font class="keywordflow">throw</font>(std::out_of_range)
00152   {
00153     <font class="keywordflow">if</font> ((row &lt; 1) || (row &gt; 4) || (col &lt; 1) || (col &gt; 4))
00154       <font class="keywordflow">throw</font> std::out_of_range(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"matrix row or col out of bounds"</font>));
00155 
00156     <font class="keywordflow">return</font> m[<a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(row,col)];
00157   }
00158 
<a name="l00159"></a><a class="code" href="classbase_1_1Matrix4.html#a60">00159</a>   Real&amp; <a class="code" href="classbase_1_1Matrix4.html#a14">operator()</a>(Int row, Int col) <font class="keywordflow">throw</font>()
00160   {
00161 <font class="preprocessor">#ifdef DEBUG</font>
00162 <font class="preprocessor"></font>    <font class="keywordflow">return</font> <a class="code" href="classbase_1_1Matrix4.html#a12">at</a>(row,col);
00163 <font class="preprocessor">#else</font>
00164 <font class="preprocessor"></font>    <font class="keywordflow">return</font> <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,col);
00165 <font class="preprocessor">#endif</font>
00166 <font class="preprocessor"></font>  }
00167 
<a name="l00168"></a><a class="code" href="classbase_1_1Matrix4.html#a61">00168</a>   <font class="keyword">const</font> Real&amp; <a class="code" href="classbase_1_1Matrix4.html#a14">operator()</a>(Int row, Int col) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00169   {
00170 <font class="preprocessor">#ifdef DEBUG</font>
00171 <font class="preprocessor"></font>    <font class="keywordflow">return</font> <a class="code" href="classbase_1_1Matrix4.html#a12">at</a>(row,col);
00172 <font class="preprocessor">#else</font>
00173 <font class="preprocessor"></font>    <font class="keywordflow">return</font> <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,col);
00174 <font class="preprocessor">#endif</font>
00175 <font class="preprocessor"></font>  }
00176 
00177 
<a name="l00178"></a><a class="code" href="classbase_1_1Matrix4.html#a62">00178</a>   Vector4 <a class="code" href="classbase_1_1Matrix4.html#a16">row</a>(Int row) <font class="keyword">const</font>         <font class="comment">// extract row vector</font>
00179   { <font class="keywordflow">return</font> Vector4(<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,1),<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,2),<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,3),<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,4)); }
00180 
<a name="l00181"></a><a class="code" href="classbase_1_1Matrix4.html#a63">00181</a>   Vector4 <a class="code" href="classbase_1_1Matrix4.html#a17">column</a>(Int col) <font class="keyword">const</font>      <font class="comment">// extract column vector</font>
00182   { <font class="keywordflow">return</font> Vector4(<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,col),<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,col),<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,col),<a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,col)); }
00183 
<a name="l00184"></a><a class="code" href="classbase_1_1Matrix4.html#a64">00184</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a18">setRow</a>(Int row, <font class="keyword">const</font> Vector3&amp; r) <font class="keywordflow">throw</font>()
00185   { <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,1)=r.x; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,2)=r.y; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,3)=r.z; }
00186 
<a name="l00187"></a><a class="code" href="classbase_1_1Matrix4.html#a65">00187</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a18">setRow</a>(Int row, <font class="keyword">const</font> Vector4&amp; r) <font class="keywordflow">throw</font>()
00188   { <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,1)=r.x; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,2)=r.y; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,3)=r.z; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(row,4)=r.w; }
00189 
<a name="l00190"></a><a class="code" href="classbase_1_1Matrix4.html#a66">00190</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a20">setColumn</a>(Int col, <font class="keyword">const</font> Vector3&amp; c) <font class="keywordflow">throw</font>()
00191   { <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,col)=c.x; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,col)=c.y; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,col)=c.z; }
00192 
<a name="l00193"></a><a class="code" href="classbase_1_1Matrix4.html#a67">00193</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a20">setColumn</a>(Int col, <font class="keyword">const</font> Vector4&amp; c) <font class="keywordflow">throw</font>()
00194   { <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(1,col)=c.x; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(2,col)=c.y; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(3,col)=c.z; <a class="code" href="classbase_1_1Matrix4.html#a10">e</a>(4,col)=c.w; }
00195 
<a name="l00196"></a><a class="code" href="classbase_1_1Matrix4.html#a68">00196</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a22">swapColumns</a>(Int col1, Int col2) <font class="keywordflow">throw</font>(std::out_of_range)
00197   {
00198     <font class="keywordflow">if</font> ((col1 &lt; 1) || (col1 &gt; 4) || (col2 &lt; 1) || (col2 &gt; 4))
00199       <font class="keywordflow">throw</font> std::out_of_range(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"matrix col out of bounds"</font>));
00200 
00201     Vector4 tmp(<a class="code" href="classbase_1_1Matrix4.html#a17">column</a>(col1));
00202     <a class="code" href="classbase_1_1Matrix4.html#a20">setColumn</a>(col1,<a class="code" href="classbase_1_1Matrix4.html#a17">column</a>(col2));
00203     <a class="code" href="classbase_1_1Matrix4.html#a20">setColumn</a>(col2,tmp);
00204   }
00205 
<a name="l00206"></a><a class="code" href="classbase_1_1Matrix4.html#a69">00206</a>   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a23">swapRows</a>(Int row1, Int row2) <font class="keywordflow">throw</font>(std::out_of_range)
00207   {
00208     <font class="keywordflow">if</font> ((row1 &lt; 1) || (row1 &gt; 4) || (row2 &lt; 1) || (row2 &gt; 4))
00209       <font class="keywordflow">throw</font> std::out_of_range(<a class="code" href="base.html#a12">Exception</a>(<font class="stringliteral">"matrix row out of bounds"</font>));
00210 
00211     Vector4 tmp(<a class="code" href="classbase_1_1Matrix4.html#a16">row</a>(row1));
00212     <a class="code" href="classbase_1_1Matrix4.html#a18">setRow</a>(row1,<a class="code" href="classbase_1_1Matrix4.html#a16">row</a>(row2));
00213     <a class="code" href="classbase_1_1Matrix4.html#a18">setRow</a>(row2,tmp);
00214   }
00215 
00216 
<a name="l00217"></a><a class="code" href="classbase_1_1Matrix4.html#a70">00217</a>   Vector4 <a class="code" href="classbase_1_1Matrix4.html#a24">operator[]</a>(Int r) <font class="keyword">const</font>  <font class="comment">// row</font>
00218   { <font class="keywordflow">return</font> <a class="code" href="classbase_1_1Matrix4.html#a16">row</a>(r); }
00219 
00220 
<a name="l00221"></a><a class="code" href="classbase_1_1Matrix4.html#a71">00221</a>   <font class="keywordtype">int</font> <a class="code" href="classbase_1_1Matrix4.html#a25">index</a>(Int row, Int col) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00222   { <font class="keywordflow">return</font> <a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(row,col); }
00223 
<a name="l00224"></a><a class="code" href="classbase_1_1Matrix4.html#a72">00224</a>   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a26">operator=</a>(<font class="keyword">const</font> Matrix4&amp; src) <font class="keywordflow">throw</font>()
00225   { 
00226     <font class="keywordflow">if</font> (&amp;src != <font class="keyword">this</font>)
00227       <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0; i&lt;16; i++)
00228         m[i] = src.m[i];
00229     <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00230   }
00231 
00232 
<a name="l00233"></a><a class="code" href="classbase_1_1Matrix4.html#a73">00233</a>   <font class="keywordtype">bool</font> <a class="code" href="classbase_1_1Matrix4.html#a27">operator==</a>(<font class="keyword">const</font> Matrix4&amp; m1) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00234   {
00235     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0; i&lt;16; i++)
00236       <font class="keywordflow">if</font> (m1.m[i]!=m[i]) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00237     <font class="keywordflow">return</font> <font class="keyword">true</font>;
00238   }
00239 
<a name="l00240"></a><a class="code" href="classbase_1_1Matrix4.html#a74">00240</a>   <font class="keywordtype">bool</font> <a class="code" href="classbase_1_1Matrix4.html#a28">equals</a>(<font class="keyword">const</font> Matrix4&amp; m1, Real epsilon = base::epsilon) <font class="keyword">const</font> <font class="keywordflow">throw</font>()
00241   {
00242     <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i=0; i&lt;16; i++)
00243       <font class="keywordflow">if</font> (!<a class="code" href="namespace__base.html#a65">base::equals</a>(m1.m[i],m[i],epsilon)) <font class="keywordflow">return</font> <font class="keyword">false</font>;
00244     <font class="keywordflow">return</font> <font class="keyword">true</font>;
00245   }
00246 
00247 
00248   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a29">setToTranslation</a>(<font class="keyword">const</font> Vector3&amp; trans);
00249   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a30">setTranslationComponent</a>(<font class="keyword">const</font> Vector3&amp; trans);
00250   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a31">setRotationAboutZ</a>(Real angle);
00251 
00252   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a32">transpose</a>();
00253   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a33">invert</a>();
00254   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a34">negate</a>() <font class="keywordflow">throw</font>();
00255 
00256   <font class="comment">// Find LUP decomposition.  P is represented by the vector Pi, where the element</font>
00257   <font class="comment">//  values represent the column of P containing a 1. i.e. Pi[i]=j =&gt; P[i][j]=1</font>
00258   <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a35">decomposeLUP</a>(Matrix4&amp; L, Matrix4&amp; U, Vector4&amp; Pi) <font class="keyword">const</font>;
00259   
00260   <font class="comment">// Solve Ax=b for x, given b, where A=*this (returns x)</font>
00261   Vector4  <a class="code" href="classbase_1_1Matrix4.html#a36">solve</a>(<font class="keyword">const</font> Vector4&amp; b) <font class="keyword">const</font>; 
00262 
00263 
00264   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a37">operator*=</a>(<font class="keyword">const</font> Matrix4&amp; m2);
00265   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a38">operator+=</a>(<font class="keyword">const</font> Matrix4&amp; m2);
00266   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a39">operator-=</a>(<font class="keyword">const</font> Matrix4&amp; m2);
00267   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a37">operator*=</a>(<font class="keyword">const</font> Real&amp; s);
00268   Matrix4&amp; <a class="code" href="classbase_1_1Matrix4.html#a41">operator/=</a>(<font class="keyword">const</font> Real&amp; s);
00269 
00270   <a class="code" href="classbase_1_1Matrix4.html#a42">operator Matrix3</a>() <font class="keyword">const</font>;  
00271 <font class="preprocessor">#ifdef USE_OSG</font>
00272 <font class="preprocessor"></font>  operator osg::Matrix() <font class="keyword">const</font>; 
00273 <font class="preprocessor">#endif</font>
00274 <font class="preprocessor"></font>
<a name="l00275"></a><a class="code" href="classbase_1_1Matrix4.html#a90">00275</a>   <font class="keyword">const</font> Real* <a class="code" href="classbase_1_1Matrix4.html#a44">c_array</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m; }
<a name="l00276"></a><a class="code" href="classbase_1_1Matrix4.html#a91">00276</a>   Real* <a class="code" href="classbase_1_1Matrix4.html#a44">c_array</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> m; }
00277 
00278   <font class="comment">// Solve for xA = b, given LUP decomposition of A as L, U and Pi, and given b, returns x</font>
00279   <font class="keyword">static</font> Vector4 <a class="code" href="classbase_1_1Matrix4.html#d0">solveLUP</a>(<font class="keyword">const</font> Matrix4&amp; L, <font class="keyword">const</font> Matrix4&amp; U, <font class="keyword">const</font> Vector4&amp; Pi, <font class="keyword">const</font> Vector4&amp; b);
00280 
<a name="l00281"></a><a class="code" href="classbase_1_1Matrix4.html#d6">00281</a>   <font class="keyword">static</font> <font class="keywordtype">void</font> <a class="code" href="classbase_1_1Matrix4.html#a35">decomposeLUP</a>(<font class="keyword">const</font> Matrix4&amp; A, Matrix4&amp; L, Matrix4&amp; U, Vector4&amp; Pi)<font class="keyword"></font>
00282 <font class="keyword">  </font>{ A.decomposeLUP(L,U,Pi); }
00283 
00284   <font class="comment">// best to use the operators than use these directly</font>
00285   <font class="keyword">static</font> Vector4 <a class="code" href="classbase_1_1Matrix4.html#d2">matrixMulVector</a>(<font class="keyword">const</font> Matrix4&amp; m, <font class="keyword">const</font> Vector4&amp; v); <font class="comment">// m x v</font>
00286   <font class="keyword">static</font> Vector4 <a class="code" href="classbase_1_1Matrix4.html#d3">matrixMulVectorAddVector</a>(<font class="keyword">const</font> Matrix4&amp; m, <font class="keyword">const</font> Vector4&amp; v, <font class="keyword">const</font> Vector4&amp; v2); <font class="comment">// m x v + v2</font>
00287   <font class="keyword">static</font> Vector4 <a class="code" href="classbase_1_1Matrix4.html#d2">matrixMulVector</a>(<font class="keyword">const</font> Matrix4&amp; m, <font class="keyword">const</font> Vector3&amp; v); <font class="comment">// m x v</font>
00288 
00289 <font class="keyword">private</font>:
00290   Real m[16];
00291   
00292   <font class="keywordtype">void</font> setDiag(<font class="keyword">const</font> Real&amp; d)<font class="keyword"></font>
00293 <font class="keyword">  </font>{
00294     m[0] = d;
00295     m[1] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00296     m[2] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00297     m[3] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00298     m[4] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00299     m[5] = d;
00300     m[6] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00301     m[7] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00302     m[8] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00303     m[9] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00304     m[10] = d;
00305     m[11] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00306     m[12] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00307     m[13] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00308     m[14] = <a class="code" href="namespace__base.html#a5">Real</a>(0);
00309     m[15] = d;
00310   }
00311 
00312 };
00313 
00314 
00315 <font class="comment">// Operations</font>
00316 
00317 
00318 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a36">operator*</a>(<font class="keyword">const</font> Matrix4&amp; m1, <font class="keyword">const</font> Matrix4&amp; m2) <font class="comment">// Matrix multiplication</font>
00319 { Matrix4 r(m1); <font class="keywordflow">return</font> r *= m2; }
00320 
00321 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a37">operator+</a>(<font class="keyword">const</font> Matrix4&amp; m1, <font class="keyword">const</font> Matrix4&amp; m2) <font class="comment">// Addition</font>
00322 { Matrix4 r(m1); <font class="keywordflow">return</font> r += m2; }
00323 
00324 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a38">operator-</a>(<font class="keyword">const</font> Matrix4&amp; m1, <font class="keyword">const</font> Matrix4&amp; m2) <font class="comment">// Subtraction</font>
00325 { Matrix4 r(m1); <font class="keywordflow">return</font> r -= m2; }
00326 
00327 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a38">operator-</a>(<font class="keyword">const</font> Matrix4&amp; m1) <font class="comment">// Negation</font>
00328 { Matrix4 r(m1); <font class="keywordflow">return</font> r.<a class="code" href="namespace__base.html#a103">negate</a>(); }
00329 
00330 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a36">operator*</a>(<font class="keyword">const</font> Matrix4&amp; m1, <font class="keyword">const</font> Real&amp; s) <font class="comment">// Scalar multiplication</font>
00331 { Matrix4 r(m1); <font class="keywordflow">return</font> r *= s; }
00332 
00333 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a36">operator*</a>(<font class="keyword">const</font> Real&amp; s, <font class="keyword">const</font> Matrix4&amp; m1) <font class="comment">// Scalar multiplication</font>
00334 { Matrix4 r(m1); <font class="keywordflow">return</font> r *= s; }
00335 
00336 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a42">operator/</a>(<font class="keyword">const</font> Matrix4&amp; m1, <font class="keyword">const</font> Real&amp; s) <font class="comment">// Scalar division</font>
00337 { Matrix4 r(m1); <font class="keywordflow">return</font> r /= s; }
00338 
00339 
00340 <font class="keyword">inline</font> Vector3 <a class="code" href="namespace__base.html#a36">operator*</a>(<font class="keyword">const</font> Matrix4&amp; m1, <font class="keyword">const</font> Vector3&amp; v) <font class="comment">// Vector multiplication</font>
00341 { Vector4 r(Matrix4::matrixMulVector(m1,v)); <font class="keywordflow">return</font> Vector3(r.x,r.y,r.z); }
00342 
00343 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a43">transpose</a>(<font class="keyword">const</font> Matrix4&amp; m) <font class="comment">// Transpose</font>
00344 { Matrix4 r(m); <font class="keywordflow">return</font> r.<a class="code" href="namespace__base.html#a43">transpose</a>(); }
00345 
00346 <font class="keyword">inline</font> Matrix4 <a class="code" href="namespace__base.html#a44">inverse</a>(<font class="keyword">const</font> Matrix4&amp; m) <font class="comment">// Inverse</font>
00347 { Matrix4 r(m); <font class="keywordflow">return</font> r.invert(); }
00348 
00349 
00350 <font class="comment">// These functions and the structs above provide closures for common vector matrix</font>
00351 <font class="comment">//  operations.</font>
00352 <font class="comment">// For example, an expression like m*v+v2 will expand to:</font>
00353 <font class="comment">//              Matrix4::matrixMulVectorAddVector(m,v,v2);</font>
00354 <font class="comment">// rather than: Vector4 r(operator*(m,v)); r.operator+=(v2), return r</font>
00355 <font class="comment">//   (saving a couple copies between temporaries)</font>
00356 
00357 <font class="keyword">inline</font> M4V4mulV4add <a class="code" href="namespace__base.html#a37">operator+</a>(<font class="keyword">const</font> M4V4mul&amp; mv, <font class="keyword">const</font> Vector4&amp; vv)<font class="keyword"></font>
00358 <font class="keyword"></font>{ <font class="keywordflow">return</font> M4V4mulV4add(mv,vv); }
00359 
00360 <font class="keyword">inline</font> M4V4mul <a class="code" href="namespace__base.html#a36">operator*</a>(<font class="keyword">const</font> Matrix4&amp; mm, <font class="keyword">const</font> Vector4&amp; vv)<font class="keyword"></font>
00361 <font class="keyword"></font>{ <font class="keywordflow">return</font> M4V4mul(mm,vv); }
00362 
00363 <font class="keyword">inline</font> M4V4mul::operator Vector4()<font class="keyword"> const</font>
00364 <font class="keyword"></font>{ <font class="keywordflow">return</font> Matrix4::matrixMulVector(m,v); }
00365 
00366 <font class="keyword">inline</font> M4V4mulV4add::operator Vector4()<font class="keyword"> const</font>
00367 <font class="keyword"></font>{ <font class="keywordflow">return</font> Matrix4::matrixMulVectorAddVector(m,v,v2); }
00368 
00369 
00370 std::ostream&amp; <a class="code" href="namespace__base.html#a47">operator&lt;&lt;</a>(std::ostream&amp; out, <font class="keyword">const</font> Matrix4&amp; m); <font class="comment">// Output</font>
00371 
00372 
00373 } <font class="comment">// base</font>
00374 
00375 <font class="preprocessor">#endif</font>
00376 <font class="preprocessor"></font>
</pre></div><hr><address><small>Generated at Wed Aug 7 10:30:28 2002 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.8.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
