<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>OpenSim: base/Matrix4.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>base/Matrix4.cpp</h1><a href="Matrix4_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/****************************************************************************</span>
00002 <span class="comment">  Copyright (C)1996 David Jung &lt;opensim@pobox.com&gt;</span>
00003 <span class="comment"></span>
00004 <span class="comment">  This program/file is free software; you can redistribute it and/or modify</span>
00005 <span class="comment">  it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment">  the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment">  (at your option) any later version.</span>
00008 <span class="comment">  </span>
00009 <span class="comment">  This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment">  GNU General Public License for more details. (http://www.gnu.org)</span>
00013 <span class="comment">  </span>
00014 <span class="comment">  You should have received a copy of the GNU General Public License</span>
00015 <span class="comment">  along with this program; if not, write to the Free Software</span>
00016 <span class="comment">  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00017 <span class="comment">  </span>
00018 <span class="comment">  $Id: Matrix4.cpp 1029 2004-02-11 20:45:54Z jungd $</span>
00019 <span class="comment">  $Revision: 1.7 $</span>
00020 <span class="comment">  $Date: 2004-02-11 15:45:54 -0500 (Wed, 11 Feb 2004) $</span>
00021 <span class="comment">  $Author: jungd $</span>
00022 <span class="comment"> </span>
00023 <span class="comment">****************************************************************************/</span>
00024 
00025 <span class="preprocessor">#include &lt;<a class="code" href="Matrix4.html">base/Matrix4</a>&gt;</span>
00026 
00027 <span class="preprocessor">#include &lt;<a class="code" href="Serializer.html">base/Serializer</a>&gt;</span>
00028 
00029 <span class="keyword">using</span> <a class="code" href="classbase_1_1Matrix4.html">base::Matrix4</a>;
00030 <span class="keyword">using</span> <a class="code" href="classbase_1_1Vector4.html">base::Vector4</a>;
00031 <span class="keyword">using</span> <a class="code" href="classbase_1_1Matrix3.html">base::Matrix3</a>;
00032 
00033 <span class="keyword">using</span> std::ostream;
00034 
00035 
00036 <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> exchange(Real&amp; a, Real&amp; b)
00037 {
00038   <a class="code" href="namespacebase.html#a5">Real</a> t(a);
00039   a = b;
00040   b = t;
00041 }
00042 
00043 <span class="comment">// row, col element exchange</span>
00044 <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> rcswap4(Real m[], Int r, Int c) 
00045 {
00046         <a class="code" href="namespacebase.html#a5">Real</a>* rcp = &amp;m[<a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(r,c)];
00047         <a class="code" href="namespacebase.html#a5">Real</a>* crp = &amp;m[<a class="code" href="Matrix4.html#a0">MATRIX4_ACCESS</a>(c,r)];
00048         exchange(*rcp, *crp);
00049 }
00050 
00051 
00052 <span class="keywordtype">void</span> Matrix4::setToTranslation(<span class="keyword">const</span> Vector3&amp; trans)
00053 {
00054   setDiag(<a class="code" href="namespacebase.html#a5">Real</a>(1));
00055   e(1,4) = trans.x;
00056   e(2,4) = trans.y;
00057   e(3,4) = trans.z;
00058 }
00059 
00060 <span class="keywordtype">void</span> Matrix4::setTranslationComponent(<span class="keyword">const</span> Vector3&amp; trans)
00061 {
00062   e(1,4) = trans.x;
00063   e(2,4) = trans.y;
00064   e(3,4) = trans.z;
00065 }
00066 
00067 <span class="keywordtype">void</span> Matrix4::setRotationAboutZ(Real angle)
00068 {
00069   <a class="code" href="namespacebase.html#a5">Real</a> cosa = <a class="code" href="namespacebase.html#a65">cos</a>(angle);
00070   <a class="code" href="namespacebase.html#a5">Real</a> sina = <a class="code" href="namespacebase.html#a64">sin</a>(angle);
00071   setDiag(<a class="code" href="namespacebase.html#a5">Real</a>(1));
00072   e(1,1)=cosa; e(1,2)=-sina;
00073   e(2,1)=sina; e(2,2)=cosa;
00074 }
00075 
00076 
00077 Matrix4&amp; Matrix4::transpose()
00078 {
00079   rcswap4(m,1,2); rcswap4(m,1,3); rcswap4(m,1,4);
00080   rcswap4(m,2,3); rcswap4(m,2,4);
00081   rcswap4(m,3,4);
00082 
00083   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00084 }
00085 
00086 
00087 Matrix4&amp; Matrix4::invert()
00088 {
00089   <span class="comment">// Solve AX = I by solving 4 eqns: Ax = e (for each e a col of I)</span>
00090   Matrix4 I; <span class="comment">// identity</span>
00091   Matrix4 <a class="code" href="Globals_8h.html#a16">X</a>, A(*<span class="keyword">this</span>);
00092   <a class="code" href="classbase_1_1Vector4.html">Vector4</a> x;
00093   
00094   Matrix4 L,U;
00095   <a class="code" href="classbase_1_1Vector4.html">Vector4</a> <a class="code" href="namespacebase_1_1consts.html#a8">Pi</a>;
00096   
00097   A.decomposeLUP(L,U,Pi);
00098   
00099   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> c=1; c&lt;=4; c++) {
00100     x = solveLUP(L,U,Pi,I.column(c));
00101     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> r=1; r&lt;=4; r++) <a class="code" href="Globals_8h.html#a16">X</a>.e(r,c) = x[r];
00102   }
00103   
00104   <span class="keywordflow">return</span> (*<span class="keyword">this</span> = <a class="code" href="Globals_8h.html#a16">X</a>);
00105 
00106 }
00107 
00108 
00109 <span class="keywordtype">void</span> Matrix4::decomposeLUP(Matrix4&amp; L, Matrix4&amp; U, <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; Pi)<span class="keyword"> const</span>
00110 <span class="keyword"></span>{
00111   <a class="code" href="namespacebase.html#a5">Real</a> p,a;
00112   <span class="keywordtype">int</span> kp,i,j,k;
00113   Matrix4 AA(*<span class="keyword">this</span>);
00114 
00115   <span class="keywordflow">for</span>(i=1; i&lt;=4; i++) <a class="code" href="namespacebase_1_1consts.html#a8">Pi</a>[i] = i;
00116   <span class="keywordflow">for</span>(k=1; k&lt;=4-1; k++) {
00117     p = <a class="code" href="namespacebase.html#a5">Real</a>(0); kp = 1;
00118     <span class="keywordflow">for</span>(i=k; i&lt;=4; i++) {
00119       a = <a class="code" href="namespacebase.html#a5">Real</a>(base::abs(AA.e(i,k)));
00120       <span class="keywordflow">if</span> ( a &gt; p ) {
00121         p = a;
00122         kp = i;
00123       }
00124     }
00125     <span class="keywordflow">if</span> (p == <a class="code" href="namespacebase.html#a5">Real</a>(0))  
00126       <span class="keywordflow">throw</span> std::invalid_argument(<a class="code" href="base.html#a15">Exception</a>(<span class="stringliteral">"matrix is singular"</span>));
00127     
00128     exchange(Pi[k],Pi[kp]);
00129     <span class="keywordflow">for</span>(i=1; i&lt;=4;i++) exchange(AA.e(k,i),AA.e(kp,i));
00130     
00131     <span class="keywordflow">for</span>(i=k+1; i&lt;=4;i++) {
00132       AA.e(i,k) /= AA.e(k,k);
00133       <span class="keywordflow">for</span>(j=k+1; j&lt;=4; j++)
00134         AA.e(i,j) -= AA.e(i,k)*AA.e(k,j);
00135     }
00136   }
00137   
00138   <span class="keywordflow">for</span>(i=1;i&lt;=4;i++) {
00139     <span class="keywordflow">for</span>(j=1;j&lt;=4;j++)
00140       <span class="keywordflow">if</span> (i&gt;j) {
00141         L.e(i,j) = AA.e(i,j); U.e(i,j) = <a class="code" href="namespacebase.html#a5">Real</a>(0);
00142       }
00143       <span class="keywordflow">else</span> {
00144         U.e(i,j) = AA.e(i,j); L.e(i,j) = <a class="code" href="namespacebase.html#a5">Real</a>(0);
00145       }
00146     L.e(i,i) = <a class="code" href="namespacebase.html#a5">Real</a>(1);
00147     
00148   }
00149 
00150 }
00151 
00152 
00153 <a class="code" href="classbase_1_1Vector4.html">Vector4</a> Matrix4::solve(<span class="keyword">const</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; b)<span class="keyword"> const</span>
00154 <span class="keyword"></span>{
00155   Matrix4 L,U;
00156   <a class="code" href="classbase_1_1Vector4.html">Vector4</a> <a class="code" href="namespacebase_1_1consts.html#a8">Pi</a>;
00157 
00158   decomposeLUP(L,U,Pi);
00159   <span class="keywordflow">return</span> solveLUP(L,U,Pi,b);
00160 }
00161 
00162 
00163 Matrix4&amp; Matrix4::negate() <span class="keywordflow">throw</span>()
00164 {
00165   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;16; i++)
00166     m[i]=-m[i];
00167   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00168 }
00169 
00170 
00171 <span class="comment">// Operators</span>
00172 
00173 <span class="comment">// multiplication</span>
00174 Matrix4&amp; Matrix4::operator*=(<span class="keyword">const</span> Matrix4&amp; m2)
00175 {
00176   <span class="comment">// !!! optimize (unroll loops)</span>
00177   Matrix4 tmp;
00178 
00179   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> row=1; row&lt;=4; row++)
00180     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> col=1; col&lt;=4; col++)
00181       tmp.e(row,col) =  (e(row,1) * m2.e(1,col)) + (e(row,2) * m2.e(2,col))
00182                       + (e(row,3) * m2.e(3,col)) + (e(row,4) * m2.e(4,col));
00183  
00184   <span class="keywordflow">return</span> (*<span class="keyword">this</span> = tmp);
00185 }
00186 
00187 <span class="comment">// addition</span>
00188 Matrix4&amp; Matrix4::operator+=(<span class="keyword">const</span> Matrix4&amp; m2)
00189 {
00190   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;16; i++)
00191     <a class="code" href="structbase_1_1M4V4mulV4add.html#base_1_1M4V4mulV4addo0">m</a>[i] += m2.m[i];
00192   <span class="keywordflow">return</span> (*this);
00193 }
00194 
00195 <span class="comment">// subtration</span>
00196 Matrix4&amp; Matrix4::operator-=(<span class="keyword">const</span> Matrix4&amp; m2)
00197 {
00198   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;16; i++)
00199     <a class="code" href="structbase_1_1M4V4mulV4add.html#base_1_1M4V4mulV4addo0">m</a>[i] -= m2.m[i];
00200   <span class="keywordflow">return</span> (*this);
00201 }
00202 
00203 <span class="comment">// Scalar multiplication</span>
00204 Matrix4&amp; Matrix4::operator*=(<span class="keyword">const</span> Real&amp; s)
00205 {
00206   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;16; i++)
00207     <a class="code" href="structbase_1_1M4V4mulV4add.html#base_1_1M4V4mulV4addo0">m</a>[i] *= s;
00208   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00209 }
00210 
00211 <span class="comment">// Scalar division</span>
00212 Matrix4&amp; Matrix4::operator/=(<span class="keyword">const</span> Real&amp; s)
00213 {
00214   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;16; i++)
00215     <a class="code" href="structbase_1_1M4V4mulV4add.html#base_1_1M4V4mulV4addo0">m</a>[i] /= s;
00216   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
00217 }
00218 
00219 
00220 Matrix4::operator Matrix3()<span class="keyword"> const</span>
00221 <span class="keyword"></span>{
00222   Matrix3 r;
00223   r.e(1,1) = e(1,1); r.e(1,2)=e(1,2); r.e(1,3)=e(1,3);
00224   r.e(2,1) = e(2,1); r.e(2,2)=e(2,2); r.e(2,3)=e(2,3);
00225   r.e(3,1) = e(3,1); r.e(3,2)=e(3,2); r.e(3,3)=e(3,3);
00226   <span class="keywordflow">return</span> r;
00227 }
00228 
00229 
00230 <span class="preprocessor">#ifdef USE_OSG</span>
00231 <span class="preprocessor"></span>Matrix4::operator osg::Matrix()<span class="keyword"> const</span>
00232 <span class="keyword"></span>{
00233 <span class="preprocessor">#ifdef OSG_USE_DOUBLE_MATRICES</span>
00234 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">double</span> osgreal;
00235 <span class="preprocessor">#else</span>
00236 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">float</span> osgreal;
00237 <span class="preprocessor">#endif</span>
00238 <span class="preprocessor"></span>  <span class="comment">// NB: This relies on the two types having the same</span>
00239   osg::Matrix mat;
00240   osgreal* _mat = mat.ptr();
00241   <span class="keywordflow">for</span>(<a class="code" href="namespacebase.html#a2">Int</a> e=0; e&lt;16; e++)
00242     _mat[e] = <a class="code" href="structbase_1_1M4V4mulV4add.html#base_1_1M4V4mulV4addo0">m</a>[e];
00243   <span class="keywordflow">return</span> mat;
00244 }
00245 <span class="preprocessor">#endif</span>
00246 <span class="preprocessor"></span>
00247 
00248 <a class="code" href="classbase_1_1Vector4.html">Vector4</a> Matrix4::matrixMulVector(<span class="keyword">const</span> Matrix4&amp; m, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; v) 
00249 { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>(m.m[0]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[4]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[8]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[12]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>,
00250                  m.m[1]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[5]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[9]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[13]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>,
00251                  m.m[2]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[6]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[10]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[14]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>,
00252                  m.m[3]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[7]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[11]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[15]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>);
00253 }
00254 
00255 <span class="comment">/* above is equivelent to: (which is slower but easier to read)</span>
00256 <span class="comment">Vector4 Matrix4::matrixMulVector(const Matrix4&amp; m, const Vector4&amp; v) </span>
00257 <span class="comment">{ return Vector4(m.e(1,1)*v.x+m.e(1,2)*v.y+m.e(1,3)*v.z+m.e(1,4)*v.w,</span>
00258 <span class="comment">                 m.e(2,1)*v.x+m.e(2,2)*v.y+m.e(2,3)*v.z+m.e(2,4)*v.w,</span>
00259 <span class="comment">                 m.e(3,1)*v.x+m.e(3,2)*v.y+m.e(3,3)*v.z+m.e(3,4)*v.w,</span>
00260 <span class="comment">                 m.e(4,1)*v.x+m.e(4,2)*v.y+m.e(4,3)*v.z+m.e(4,4)*v.w);</span>
00261 <span class="comment">}</span>
00262 <span class="comment">*/</span>
00263 
00264 <a class="code" href="classbase_1_1Vector4.html">Vector4</a> Matrix4::matrixMulVector(<span class="keyword">const</span> Matrix4&amp; m, <span class="keyword">const</span> Vector3&amp; v) 
00265 { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>(m.m[0]*v.x+m.m[4]*v.y+m.m[8]*v.z+m.m[12],
00266                  m.m[1]*v.x+m.m[5]*v.y+m.m[9]*v.z+m.m[13],
00267                  m.m[2]*v.x+m.m[6]*v.y+m.m[10]*v.z+m.m[14],
00268                  m.m[3]*v.x+m.m[7]*v.y+m.m[11]*v.z+m.m[15]);
00269 }
00270 
00271 <a class="code" href="classbase_1_1Vector4.html">Vector4</a> Matrix4::matrixMulVectorAddVector(<span class="keyword">const</span> Matrix4&amp; m, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; v, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; v2) 
00272 { <span class="keywordflow">return</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>(m.m[0]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[4]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[8]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[12]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>+v2.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>,
00273                  m.m[1]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[5]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[9]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[13]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>+v2.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>,
00274                  m.m[2]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[6]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[10]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[14]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>+v2.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>,
00275                  m.m[3]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o0">x</a>+m.m[7]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o1">y</a>+m.m[11]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o2">z</a>+m.m[15]*v.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>+v2.<a class="code" href="classbase_1_1Vector4.html#base_1_1Vector4o3">w</a>);
00276 }
00277 
00278 
00279 <span class="comment">// Solve for Ax = b, given LUP decomposition of A as L, U and Pi, and given b, returns x</span>
00280 <a class="code" href="classbase_1_1Vector4.html">Vector4</a> Matrix4::solveLUP(<span class="keyword">const</span> Matrix4&amp; L, <span class="keyword">const</span> Matrix4&amp; U, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; Pi, <span class="keyword">const</span> <a class="code" href="classbase_1_1Vector4.html">Vector4</a>&amp; b)
00281 {
00282   <span class="keywordtype">int</span> i,j;
00283   <a class="code" href="classbase_1_1Vector4.html">Vector4</a> y, x;
00284   <a class="code" href="namespacebase.html#a5">Real</a> s;
00285   <span class="comment">// forward subst.</span>
00286   <span class="keywordflow">for</span>(i=1;i&lt;=4;i++) {
00287     s = <a class="code" href="namespacebase.html#a5">Real</a>(0);
00288     <span class="keywordflow">for</span>(j=1;j&lt;=i-1;j++) s += L.e(i,j)*y[j];
00289     y[i] = b[int(Pi[i])] - s;
00290   }
00291   <span class="comment">// backward subst.</span>
00292   <span class="keywordflow">for</span>(i=4;i&gt;=1;i--) {
00293     s = <a class="code" href="namespacebase.html#a5">Real</a>(0);
00294     <span class="keywordflow">for</span>(j=i+1;j&lt;=4;j++) s += U.e(i,j)*x[j];
00295     x[i] = (y[i] - s)/(U.e(i,i));
00296   }
00297   <span class="keywordflow">return</span> x;
00298 }
00299 
00300 
00301 <span class="keywordtype">void</span> Matrix4::serialize(Serializer&amp; s)
00302 {
00303   <span class="keywordflow">for</span>(<a class="code" href="namespacebase.html#a2">Int</a> i=0; i&lt;15; i++) 
00304     s(m[i]);
00305 }
00306 
00307 
00308 <span class="comment">// output</span>
<a name="l00309"></a><a class="code" href="namespacebase.html#a131">00309</a> ostream&amp; <a class="code" href="namespacebase.html#a66">base::operator&lt;&lt;</a>(ostream&amp; out, <span class="keyword">const</span> <a class="code" href="classbase_1_1Matrix4.html">Matrix4</a>&amp; m)
00310 {
00311   <span class="keywordflow">return</span> out &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(1,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(1,2) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(1,3) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(1,4) &lt;&lt; std::endl
00312              &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(2,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(2,2) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(2,3) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(2,4) &lt;&lt; std::endl
00313              &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(3,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(3,2) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(3,3) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(3,4) &lt;&lt; std::endl
00314              &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(4,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(4,2) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(4,3) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; m.<a class="code" href="classbase_1_1Matrix4.html#base_1_1Matrix4a10">e</a>(4,4) &lt;&lt; std::endl;
00315 }
00316 
00317 
00318 
00319 
00320 
00321 
00322 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Jul 29 15:56:07 2004 for OpenSim by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
